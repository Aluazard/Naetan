### Dark World Wizard Society Events

namespace = DWSOC

### Recruitment ###

# Do you approve of "alternative views"? - Recruit
narrative_event = {
	id = DWSOC.1201
	desc = DWSOC1201
	picture = wizard_society_approach3
	is_triggered_only = yes # targetted_decision
	title = dw_recruitment_drive
	prisoner = no # pre-trigger
	immediate = {
		if = {
			limit = { NOT = { event_target:dw_wizard_recruiter = { always = yes } } }
			FROMFROM = { save_event_target_as = dw_wizard_recruiter }
		}
		save_event_target_as = dw_wizard_recruit
	}
	fail_trigger_effect = {
		clr_character_flag = being_recruited_by_the_chosen
		clr_character_flag = dw_chosen_attempted_recruitment
	}
	#Approving of heretics
	option = {
		name = DWSOC1201A
		reverse_opinion = {
			who = event_target:dw_wizard_recruiter
			modifier = opinion_agreed_with_opinion
			years = 5
		}
		hidden_effect = { 
			narrative_event = { id = DWSOC.1202 days = 3 } 
		}
		ai_chance = {
			factor = 75
			modifier = {
				factor = 1.5
				trait = trusting
			}
			modifier = {
				factor = 1.5
				trait = scholar
			}
			modifier = {
				factor = 1.5
				trait = lunatic
			}
			modifier = {
				factor = 1.5
				trait = erudite
			}
			modifier = {
				factor = 1.5
				trait = cynical
			}
		}
	}
	#Disapproving of heretics
	option = {
		name = DWSOC1201B
		reverse_opinion = {
			who = event_target:dw_wizard_recruiter
			modifier = opinion_disagreed_with_opinion
			years = 5
		}
		set_character_flag = disapproves_of_satanism
		clr_character_flag = being_recruited_by_the_chosen
		hidden_effect = { 
			event_target:dw_wizard_recruiter = {
				increase_visibility_effect = yes # Visibility increased by 5 for the failed probing attempt
				narrative_event = { id = DWSOC.1203 days = 15 } 
			} 
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 5
				has_pious_trait_trigger = yes
			}
			modifier = {
				factor = 2
				has_crusade_trait_trigger = yes
			}
		}
	}
}
## We've an interested party - Recruiter
narrative_event = {
	id = DWSOC.1202
	desc = DWSOC1202
	picture = wizard_society_approach3
	is_triggered_only = yes # .1201
	title = dw_recruitment_drive
	option = { # Let's invite them
		name = DWSOC1202A
		hidden_effect = {
			event_target:dw_wizard_recruit = { narrative_event = { id = DWSOC.1208 days = 5 } }
		}
	}
}
## We've been rejected - Recruiter
narrative_event = {
	id = DWSOC.1203
	desc = DWSOC1203
	picture = wizard_society_approach3
	is_triggered_only = yes # .1201
	title = dw_recruitment_drive
	option = { # Disappointing
		name = DWSOC1203A
	}
}
## I'm a member of the society - Recruit
narrative_event = {
	id = DWSOC.1208
	desc = DWSOC1208
	picture = wizard_society_approach3
	is_triggered_only = yes # .1203 or .1202
	title = dw_recruitment_drive
	option = { # Joins
		name = DWSOC1208A
		join_society = dw_the_wizards
		hidden_effect = {
			clr_character_flag = being_recruited_by_the_chosen
			clr_character_flag = dw_chosen_attempted_recruitment
			event_target:dw_wizard_recruiter = { narrative_event = { id = DWSOC.1209 days = 3 } }
		}
	}
}
## We've a new member of the society - Recruiter
narrative_event = {
	id = DWSOC.1209
	desc = DWSOC1209
	picture = wizard_society_approach3
	is_triggered_only = yes # .1203 or .1202
	title = dw_recruitment_drive
	option = { # I've strengthened our society
		name = DWSOC1209A
		add_society_currency_medium_effect = yes
	}
}

#MISSIONS

#Mission tombola
character_event = {
    id = DWSOC.1000
    hide_window = yes

    is_triggered_only = yes
    
	is_in_society = yes

	trigger = {
		society_member_of = dw_the_wizards
		has_any_quest = no
		NOT = { has_character_modifier = quest_cooldown_timer }
		NOT = { is_inaccessible_trigger = yes }
		prisoner = no
		society = {
			any_society_member = {
				NOT = { character = ROOT }
				prisoner = no
				is_within_diplo_range = ROOT
				opinion = { who = ROOT value = 0 }
			}
		}
	}

    immediate = {
    	#Picks out mission giver
    	random_list = {
    		20 = { #International society member
    			society = {
    				random_society_member = {
    					limit = { 	
							NOT = { character = ROOT }
							prisoner = no
    						is_within_diplo_range = ROOT
							opinion = { who = ROOT value = 0 }
    					}
    					save_event_target_as = hermetic_collaborator
    				}
    			}
    		}
    		40 = { #Realm society member
    			trigger = {
    				society = {
    					any_society_member = {
    						NOT = { character = ROOT }
    						prisoner = no
    						is_within_diplo_range = ROOT
							opinion = { who = ROOT value = 0 }
							same_realm = ROOT
    					}
    				}
    			}
    			society = {
    				random_society_member = {
    					limit = { 	
    						NOT = { character = ROOT }
    						prisoner = no
    						is_within_diplo_range = ROOT
							opinion = { who = ROOT value = 0 }
							same_realm = ROOT
    					}
    					save_event_target_as = hermetic_collaborator
    				}
    			}
    		}
    		40 = { #Apprentice
    			trigger = {
    				any_courtier_or_vassal = { has_minor_title =  title_dw_the_wizards_apprentice prisoner = no }
					society_member_of = dw_the_wizards
    			}
    			random_courtier_or_vassal = {
    				limit = { has_minor_title =  title_dw_the_wizards_apprentice }
    				save_event_target_as = hermetic_collaborator
    			}
    		}
    	}


    	#Randomizes mission
    	random_list = {

    		20 = { #Find an apprentice
    			trigger = {
    				NOT = { any_courtier_or_vassal = { has_minor_title =  title_dw_the_wizards_apprentice } }
    				ai = no
    			}
    			event_target:hermetic_collaborator = { character_event = { id = DWSOC.1404 days = 7 random = 7 } }
    		}
			
			20 = { #Build a laboratory
				trigger = {
					NOT = { has_character_flag = building_laboratory }
					NOT = { has_character_flag = built_laboratory }
					OR = {
    					ai = no
    					society_rank == 4
    				}
    				is_landed = yes
				}
				event_target:hermetic_collaborator = { character_event = { id = DWSOC.1120 days = 7 random = 7 } }
			}
			
			105 = { # AI bypasses missions at times
				modifier = {
					factor = 0
					ai = no
				}
				random_list = {
					70 = {
						modifier = {
							factor = 0.9
							society_influence >= 30
						}
						modifier = {
							factor = 0.9
							society_influence >= 40
						}
						modifier = {
							factor = 0.8
							society_influence >= 50
						}
						modifier = {
							factor = 0.7
							society_influence >= 70
						}
						modifier = {
							factor = 0.6
							society_influence >= 80
						}
						modifier = {
							factor = 0.5
							society_influence >= 90
						}
						add_mission_succeed_influence_effect = yes
					}
					30 = {
						add_mission_fail_influence_effect = yes
					}
				}
			}
			
			175 = {
				modifier = {
					factor = 0
					ai = no
				}
				#Do nothing for AI
			}
    	}
    }
}

#Mission: Building a Laboratory
#Flags:
#Temporary:
#building_laboratory (cleared at end)
#decided_on_glass (cleared at end)
#decided_on_crucibles (cleared at end)
#decided_on_tools (cleared at end)
#decided_on_books (cleared at end)
#Not Temporary:
#built_laboratory (not cleared -> set at end, marks this as done for this character)
#hidden_lab (not cleared -> to be used to weight stealing of secrets)
#very_hidden_lab (not cleared -> to be used to weight stealing of secrets)
character_event = {
	id = DWSOC.1100
	desc = EVTDESC_MNM_1100
	picture = GFX_evt_castle_construction
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_1100
		hidden_tooltip = {
			character_event = { id = DWSOC.1101 days = 7 }
			set_variable = { which = laboratory_level value = 1 }
		}
	}
	option = {
		name = EVTOPTB_MNM_1100
		clr_character_flag = building_laboratory
		wealth = 50
	}
}

#Where should the Laboratory be built?
character_event = { 
	id = DWSOC.1101
	desc = EVTDESC_MNM_1101
	picture = GFX_evt_castle_construction
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	trigger = {
		has_quest = quest_dw_the_wizards_build_laboratory
	}

	option = {
		name = EVTOPTA_MNM_1101 #In my Castle, hidden away
		custom_tooltip = {
			text = hidden_lab_tooltip
			set_character_flag = hidden_lab
		}
		hidden_effect = {
			change_variable = { which = laboratory_level value = 2 }
			character_event = { id = DWSOC.1102 days = 30 }
		}
	}
	option = {
		name = EVTOPTB_MNM_1101 #In an accessible place
		custom_tooltip = {
			text = accessible_lab_tooltip
		}
		hidden_effect = {
			change_variable = { which = laboratory_level value = 5 }
			character_event = { id = DWSOC.1102 days = 30 }
		}
	}
	option = {
		name = EVTOPTC_MNM_1101 #On an island or other very remote place
		trigger = {
			OR = {
				intrigue = 15
				trait = paranoid
			}
			capital_scope = { port = yes }
		}
		custom_tooltip = {
			text = very_hidden_lab_tooltip
			set_character_flag = very_hidden_lab
		}
		hidden_effect = {
			change_variable = { which = laboratory_level value = 3 }
			character_event = { id = DWSOC.1102 days = 30 }
		}
	}
	option = {
		name = EVTOPTD_MNM_1101 #On an island or other very remote place
		trigger = {
			OR = {
				intrigue = 15
				trait = paranoid
			}
			capital_scope = {
				port = no
			}
		}
		custom_tooltip = {
			text = very_hidden_lab_tooltip
			set_character_flag = very_hidden_lab
		}
		hidden_effect = {
			change_variable = { which = laboratory_level value = 3 }
			character_event = { id = DWSOC.1102 days = 30 }
		}
	}
}

#What kind of laboratory should we build?
character_event = { 
	id = DWSOC.1102
	desc = EVTDESC_MNM_1102
	picture = GFX_evt_weaponsmith
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_1102 #
		custom_tooltip = {
			text = cheap_laboratory_setup
		}
		hidden_effect = {
			change_variable = { which = laboratory_level value = 1 }
			set_variable = { which = lab_ambition value = 1 }
			random_list = {
				25 = {
					trigger = { NOT = { has_character_flag = decided_on_glass } }
					character_event = { id = DWSOC.1103 days = 60 }
				}
				25 = {
					trigger = { NOT = { has_character_flag = decided_on_crucibles } }
					character_event = { id = DWSOC.1104 days = 60 }
				}
				25 = {
					trigger = { NOT = { has_character_flag = decided_on_tools } }
					character_event = { id = DWSOC.1105 days = 60 }
				}
				25 = {
					trigger = { NOT = { has_character_flag = decided_on_books } }
					character_event = { id = DWSOC.1106 days = 60 }
				}
			}
			random_list = { #Accidents
				25 = { } #Nothing Happens
				25 = { character_event = { id = DWSOC.1113 days = 30 } }
				25 = { character_event = { id = DWSOC.1114 days = 30 } }
				25 = { character_event = { id = DWSOC.1115 days = 30 } }
			}
		}
	}
	option = {
		name = EVTOPTB_MNM_1102 #
		wealth = -20
		custom_tooltip = {
			text = efficient_laboratory_setup
		}
		hidden_effect = {
			change_variable = { which = laboratory_level value = 3 }
			set_variable = { which = lab_ambition value = 2 }
			random_list = {
				25 = {
					trigger = { NOT = { has_character_flag = decided_on_glass } }
					character_event = { id = DWSOC.1103 days = 30 }
				}
				25 = {
					trigger = { NOT = { has_character_flag = decided_on_crucibles } }
					character_event = { id = DWSOC.1104 days = 30 }
				}
				25 = {
					trigger = { NOT = { has_character_flag = decided_on_tools } }
					character_event = { id = DWSOC.1105 days = 30 }
				}
				25 = {
					trigger = { NOT = { has_character_flag = decided_on_books } }
					character_event = { id = DWSOC.1106 days = 30 }
				}
			}
			random_list = { #Accidents
				25 = { } #Nothing Happens
				25 = { character_event = { id = DWSOC.1113 days = 45 } }
				25 = { character_event = { id = DWSOC.1114 days = 45 } }
				25 = { character_event = { id = DWSOC.1115 days = 45 } }
			}
		}
	}
	option = {
		name = EVTOPTC_MNM_1102 #State of the Art.
		trigger = {
			OR = {
				learning = 15
				AND = { #Both master and apprentice have acceptable learning
					learning = 12
					any_courtier_or_vassal = {
						has_minor_title = title_dw_the_wizards_apprentice
						learning = 12
					}
				}
			}
		}
		wealth = -35
		custom_tooltip = {
			text = large_laboratory_setup
		}
		hidden_effect = {
			change_variable = { which = laboratory_level value = 5 }
			set_variable = { which = lab_ambition value = 3 }
			random_list = {
				25 = {
					trigger = { NOT = { has_character_flag = decided_on_glass } }
					character_event = { id = DWSOC.1103 days = 30 }
				}
				25 = {
					trigger = { NOT = { has_character_flag = decided_on_crucibles } }
					character_event = { id = DWSOC.1104 days = 30 }
				}
				25 = {
					trigger = { NOT = { has_character_flag = decided_on_tools } }
					character_event = { id = DWSOC.1105 days = 30 }
				}
				25 = {
					trigger = { NOT = { has_character_flag = decided_on_books } }
					character_event = { id = DWSOC.1106 days = 30 }
				}
			}
			random_list = { #Accidents
				25 = { } #Nothing Happens
				25 = { character_event = { id = DWSOC.1113 days = 45 } }
				25 = { character_event = { id = DWSOC.1114 days = 45 } }
				25 = { character_event = { id = DWSOC.1115 days = 45 } }
			}
		}
	}
	option = {
		name = EVTOPTD_MNM_1102 #Experimental setup
		trigger = {
			OR = {
				learning = 25
				AND = { #Both have good learning
					learning = 15
					any_courtier_or_vassal = {
						has_minor_title = title_dw_the_wizards_apprentice
						learning = 15
					}
				}
			}
		}
		wealth = -50
		custom_tooltip = {
			text = extravagant_laboratory_setup
		}
		hidden_effect = {
			change_variable = { which = laboratory_level value = 8 }
			set_variable = { which = lab_ambition value = 4 }
			random_list = {
				25 = {
					trigger = { NOT = { has_character_flag = decided_on_glass } }
					character_event = { id = DWSOC.1103 days = 30 }
				}
				25 = {
					trigger = { NOT = { has_character_flag = decided_on_crucibles } }
					character_event = { id = DWSOC.1104 days = 30 }
				}
				25 = {
					trigger = { NOT = { has_character_flag = decided_on_tools } }
					character_event = { id = DWSOC.1105 days = 30 }
				}
				25 = {
					trigger = { NOT = { has_character_flag = decided_on_books } }
					character_event = { id = DWSOC.1106 days = 30 }
				}
			}
			random_list = { #Accidents
				25 = { } #Nothing Happens
				25 = { character_event = { id = DWSOC.1113 days = 45 } }
				25 = { character_event = { id = DWSOC.1114 days = 45 } }
				25 = { character_event = { id = DWSOC.1115 days = 45 } }
			}
		}
	}
}

#What kind of equipment do we need?
#Variant 1 - Flasks, Alembics, test tubes, etc
character_event = { 
	id = DWSOC.1103
	desc = EVTDESC_MNM_1103
	picture = GFX_evt_experiment
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			set_character_flag = decided_on_glass
		}
	}
	
	option = {
		name = EVTOPTA_MNM_1103 #
		custom_tooltip = {
			text = non_fancy_laboratory_glass_tooltip
		}
		hidden_effect = {
			change_variable = {
				which = laboratory_level value = 1
			}
			change_variable = { which = lab_ambition value = -1 }
			if = {
				limit = {
					check_variable = {
						which = lab_ambition
						value = 1
					}
				}
				random_list = {
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_glass } }
						character_event = { id = DWSOC.1103 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_crucibles } }
						character_event = { id = DWSOC.1104 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_tools } }
						character_event = { id = DWSOC.1105 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_books } }
						character_event = { id = DWSOC.1106 days = 30 }
					}
				}
			}
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = lab_ambition
							value = 1
						}
					}
				}
				character_event = { id = DWSOC.1107 days = 60 }
			}
		}
	}
	option = {
		name = EVTOPTB_MNM_1103 #
		wealth = -20
		custom_tooltip = {
			text = fancy_laboratory_glass_tooltip
		}
		hidden_effect = {
			change_variable = { which = laboratory_level value = 2 }
			change_variable = { which = lab_ambition value = -1 }
			if = {
				limit = {
					check_variable = {
						which = lab_ambition
						value = 1
					}
				}
				random_list = {
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_glass } }
						character_event = { id = DWSOC.1103 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_crucibles } }
						character_event = { id = DWSOC.1104 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_tools } }
						character_event = { id = DWSOC.1105 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_books } }
						character_event = { id = DWSOC.1106 days = 30 }
					}
				}
			}
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = lab_ambition
							value = 1
						}
					}
				}
				character_event = { id = DWSOC.1107 days = 60 }
			}
		}
	}
}

#Variant 2 - Crucibles
character_event = {
	id = DWSOC.1104
	desc = EVTDESC_MNM_1104
	picture = GFX_evt_experiment
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			set_character_flag = decided_on_crucibles
		}
	}

	option = {
		name = EVTOPTA_MNM_1104 #
		custom_tooltip = {
			text = non_fancy_laboratory_crucibles_tooltip
		}
		hidden_effect = {
			change_variable = { which = laboratory_level value = 1 }
			change_variable = { which = lab_ambition value = -1 }
			if = {
				limit = {
					check_variable = {
						which = lab_ambition
						value = 1
					}
				}
				random_list = {
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_glass } }
						character_event = { id = DWSOC.1103 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_crucibles } }
						character_event = { id = DWSOC.1104 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_tools } }
						character_event = { id = DWSOC.1105 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_books } }
						character_event = { id = DWSOC.1106 days = 30 }
					}
				}
			}
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = lab_ambition
							value = 1
						}
					}
				}
				character_event = { id = DWSOC.1107 days = 60 }
			}
		}
	}
	option = {
		name = EVTOPTB_MNM_1104 #
		wealth = -20
		custom_tooltip = {
			text = fancy_laboratory_crucibles_tooltip
		}
		hidden_effect = {
			change_variable = { which = laboratory_level value = 2 }
			change_variable = { which = lab_ambition value = -1 }
			if = {
				limit = {
					check_variable = {
						which = lab_ambition
						value = 1
					}
				}
				random_list = {
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_glass } }
						character_event = { id = DWSOC.1103 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_crucibles } }
						character_event = { id = DWSOC.1104 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_tools } }
						character_event = { id = DWSOC.1105 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_books } }
						character_event = { id = DWSOC.1106 days = 30 }
					}
				}
			}
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = lab_ambition
							value = 1
						}
					}
				}
				character_event = { id = DWSOC.1107 days = 60 }
			}
		}
	}
}

#Variant 3 - Iron Tools
character_event = { 
	id = DWSOC.1105
	desc = EVTDESC_MNM_1105
	picture = GFX_evt_weaponsmith
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			set_character_flag = decided_on_tools
		}
	}

	option = {
		name = EVTOPTA_MNM_1105 #
		custom_tooltip = {
			text = non_fancy_laboratory_tools_tooltip
		}
		hidden_effect = {
			change_variable = { which = laboratory_level value = 1 }
			change_variable = { which = lab_ambition value = -1 }
			if = {
				limit = {
					check_variable = {
						which = lab_ambition
						value = 1
					}
				}
				random_list = {
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_glass } }
						character_event = { id = DWSOC.1103 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_crucibles } }
						character_event = { id = DWSOC.1104 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_tools } }
						character_event = { id = DWSOC.1105 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_books } }
						character_event = { id = DWSOC.1106 days = 30 }
					}
				}
			}
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = lab_ambition
							value = 1
						}
					}
				}
				character_event = { id = DWSOC.1107 days = 60 }
			}
		}
	}
	option = {
		name = EVTOPTB_MNM_1105 #
		wealth = -20
		custom_tooltip = {
			text = fancy_laboratory_tools_tooltip
		}
		hidden_effect = {
			change_variable = { which = laboratory_level value = 2 }
			change_variable = { which = lab_ambition value = -1 }
			if = {
				limit = {
					check_variable = {
						which = lab_ambition
						value = 1
					}
				}
				random_list = {
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_glass } }
						character_event = { id = DWSOC.1103 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_crucibles } }
						character_event = { id = DWSOC.1104 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_tools } }
						character_event = { id = DWSOC.1105 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_books } }
						character_event = { id = DWSOC.1106 days = 30 }
					}
				}
			}
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = lab_ambition
							value = 1
						}
					}
				}
				character_event = { id = DWSOC.1107 days = 60 }
			}
		}
	}
}

#Variant 4 - Books
#Herbals, Lapidarii, etc
character_event = { 
	id = DWSOC.1106
	desc = EVTDESC_MNM_1106
	picture = GFX_evt_book_carolingian_script
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			set_character_flag = decided_on_books
		}
	}

	option = {
		name = EVTOPTA_MNM_1106 #
		custom_tooltip = {
			text = non_fancy_laboratory_books_tooltip
		}
		hidden_effect = {
			change_variable = { which = laboratory_level value = 1 }
			change_variable = { which = lab_ambition value = -1 }
			if = {
				limit = {
					check_variable = {
						which = lab_ambition
						value = 1
					}
				}
				random_list = {
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_glass } }
						character_event = { id = DWSOC.1103 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_crucibles } }
						character_event = { id = DWSOC.1104 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_tools } }
						character_event = { id = DWSOC.1105 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_books } }
						character_event = { id = DWSOC.1106 days = 30 }
					}
				}
			}
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = lab_ambition
							value = 1
						}
					}
				}
				character_event = { id = DWSOC.1107 days = 60 }
			}
		}
	}
	option = {
		name = EVTOPTB_MNM_1106 #
		wealth = -20
		custom_tooltip = {
			text = fancy_laboratory_books_tooltip
		}
		hidden_effect = {
			change_variable = { which = laboratory_level value = 2 }
			change_variable = { which = lab_ambition value = -1 }
			if = {
				limit = {
					check_variable = {
						which = lab_ambition
						value = 1
					}
				}
				random_list = {
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_glass } }
						character_event = { id = DWSOC.1103 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_crucibles } }
						character_event = { id = DWSOC.1104 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_tools } }
						character_event = { id = DWSOC.1105 days = 30 }
					}
					25 = {
						trigger = { NOT = { has_character_flag = decided_on_books } }
						character_event = { id = DWSOC.1106 days = 30 }
					}
				}
			}
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = lab_ambition
							value = 1
						}
					}
				}
				character_event = { id = DWSOC.1107 days = 60 }
			}
		}
	}
}

#Work is done
character_event = {
	id = DWSOC.1107
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			set_character_flag = built_laboratory
			clr_character_flag = building_laboratory
			clr_character_flag = decided_on_glass
			clr_character_flag = decided_on_crucibles
			clr_character_flag = decided_on_tools
			clr_character_flag = decided_on_books
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = laboratory_level
							value = 6
						}
					}
				}
				character_event = { id = DWSOC.1108 } # Cheap Laboratory
			}
			if = {
				limit = {
					check_variable = {
						which = laboratory_level
						value = 6
					}
					NOT = {
						check_variable = {
							which = laboratory_level
							value = 12
						}
					}
				}
				character_event = { id = DWSOC.1109 } # Normal Laboratory
			}
			if = {
				limit = {
					check_variable = {
						which = laboratory_level
						value = 12
					}
					NOT = {
						check_variable = {
							which = laboratory_level
							value = 18
						}
					}
				}
				character_event = { id = DWSOC.1110 } # Good Laboratory
			}
			if = {
				limit = {
					check_variable = {
						which = laboratory_level
						value = 18
					}
					NOT = {
						check_variable = {
							which = laboratory_level
							value = 23
						}
					}
				}
				narrative_event = { id = DWSOC.1111 } # Great Laboratory
			}
			if = {
				limit = {
					check_variable = {
						which = laboratory_level
						value = 23
					}
				}
				narrative_event = { id = DWSOC.1112 } # Best Laboratory
			}
		}
	}
}

#Finished Cheap Lab
character_event = {
	id = DWSOC.1108
	desc = EVTDESC_MNM_1108
	picture = GFX_evt_experiment
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_1108 #
		add_character_modifier = {
			name = "cheap_laboratory"
			duration = -1
		}
		hidden_effect = {
			character_event = { id = DWSOC.1122 }
		}
	}
}

#Finished Normal Lab
character_event = {
	id = DWSOC.1109
	desc = EVTDESC_MNM_1109
	picture = GFX_evt_experiment
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_1109 #
		economy_techpoints = 5
		add_character_modifier = {
			name = "normal_laboratory"
			duration = -1
		}
		hidden_effect = {
			character_event = { id = DWSOC.1122 }
		}
	}
}

#Finished Good Lab
character_event = {
	id = DWSOC.1110
	desc = EVTDESC_MNM_1110
	picture = GFX_evt_experiment
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_1110 #
		economy_techpoints = 15
		add_character_modifier = {
			name = "good_laboratory"
			duration = -1
		}
		hidden_effect = {
			character_event = { id = DWSOC.1122 }
		}
	}
}

#Finished Great Lab
narrative_event = {
	id = DWSOC.1111
	title = EVTNAME_MNM_1111
	desc = EVTDESC_MNM_1111
	picture = GFX_evt_experiment
	border = GFX_event_narrative_frame_religion
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_1111 #
		economy_techpoints = 30
		add_character_modifier = {
			name = "great_laboratory"
			duration = -1
		}
		hidden_effect = {
			character_event = { id = DWSOC.1122 }
		}
	}
}

#Finished Best Lab
narrative_event = {
	id = DWSOC.1112
	title = EVTNAME_MNM_1112
	desc = EVTDESC_MNM_1112
	picture = GFX_evt_experiment
	border = GFX_event_narrative_frame_religion
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_1112 #
		economy_techpoints = 50
		add_character_modifier = {
			name = "best_laboratory"
			duration = -1
		}
		hidden_effect = {
			character_event = { id = DWSOC.1122 }
		}
	}
}

#Laboratory Accidents

character_event = {
	id = DWSOC.1113
	desc = EVTDESC_MNM_1113
	picture = GFX_evt_burning_house_arabic
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			random_courtier = {
				save_event_target_as = sacrifice_for_science
			}
		}
	}

	option = {
		name = EVTOPTA_MNM_1113 #
		hidden_effect = {
			change_variable = { which = laboratory_level value = -2 }
		}
		if = {
			limit = { has_character_flag = hidden_lab } #Lab built in castle
			event_target:sacrifice_for_science = {
				add_maimed_trait_effect = yes
				if = {
					limit = {
						is_close_relative = ROOT
						NOT = { trait = cruel }
					}
					random_list = {
						80 = { }
						20 = { ROOT = { add_trait_depressed_effect = yes } }
					}
				}
			}
		}
	}
	option = {
		name = EVTOPTB_MNM_1113 #
		custom_tooltip = {
			text = efforts_to_improve_lab_security_tooltip
		}
		hidden_effect = {
			change_variable = { which = laboratory_level value = -1 }
		}
		wealth = -10
		if = {
			limit = { has_character_flag = hidden_lab } #Lab built in castle
			event_target:sacrifice_for_science = {
				add_maimed_trait_effect = yes
				if = {
					limit = {
						is_close_relative = ROOT
						NOT = { trait = cruel }
					}
					random_list = {
						80 = { }
						20 = { ROOT = { add_trait_depressed_effect = yes } }
					}
				}
			}
		}
	}

	after = {
		#destroy ingredients
		if = {
			limit = {
				any_artifact = {
		    		has_artifact_flag = ingredient
	    		}
			}
			destroy_random_ingredients_effect = yes
		}
	}
}

# Locals are gossiping 
character_event = {
	id = DWSOC.1114
	desc = EVTDESC_MNM_1114
	picture = GFX_evt_riots_byzantine
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_1114 #
		custom_tooltip = {
			text = accomodate_gossipers_tooltip
		}
		hidden_effect = {
			change_variable = { which = laboratory_level value = -2 }
		}
		
	}
	option = {
		name = EVTOPTB_MNM_1114 #
		prestige = -50
	}
}

#Rotting Ingredients
character_event = {
	id = DWSOC.1115
	desc = EVTDESC_MNM_1115
	picture = GFX_evt_experiment
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_1115 #
		hidden_effect = {
			change_variable = { which = laboratory_level value = -1 }
		}
	}
	option = {
		name = EVTOPTB_MNM_1115 #
		wealth = -25
		hidden_effect = {
			change_variable = { which = laboratory_level value = 1 }
		}
	}

	after = {
		#destroy ingredients
		if = {
			limit = {
				OR = {
					has_a_herb_ingredient_trigger = yes
					has_an_animal_part_ingredient_trigger = yes
				}
			}
			custom_tooltip = {
				text = random_ingredients_are_destroyed_tt
				destroy_random_herb_or_animal_part_ingredients_effect = yes
			}
		}
	}
}

#Mission: Build a Laboratory
character_event = {
    id = DWSOC.1120
    hide_window = yes
    is_triggered_only = yes
    immediate = {
		FROM = {
			society_quest_event = { id = DWSOC.1121 days = 7 random = 7 }
		}
	}
}

#Letter from quest giver
society_quest_event = {
    id = DWSOC.1121

	desc = {
		text = EVTDESC_MNM_1121
		trigger = { 
			event_target:hermetic_collaborator = {
				NOT = { has_minor_title = title_dw_the_wizards_apprentice }
			}
		}
	}
	desc = {
		text = EVTDESC_MNM_1121_apprentice
		trigger = { 
			event_target:hermetic_collaborator = {
				has_minor_title = title_dw_the_wizards_apprentice
			}
		}
	}

    is_triggered_only = yes
   
    option = {
		name = ACCEPT
		ai_chance = { factor = 100 }
		set_quest = quest_dw_the_wizards_build_laboratory
	}

	option = {
		name = DECLINE
		ai_chance = { factor = 0 }
		custom_tooltip = { text = decline_quest_tooltip }
		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}
	}
}

#Quest Completed
character_event = {
    id = DWSOC.1122
    picture = GFX_evt_experiment
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
	
	desc = {
		text = EVTDESC_MNM_1122_normal
		trigger = {
			FROM = {
				NOT = { has_character_modifier = good_laboratory }
				NOT = { has_character_modifier = great_laboratory }
				NOT = { has_character_modifier = best_laboratory }
			}
		}
	}
	
	desc = {
		text = EVTDESC_MNM_1122_rich
		trigger = {
			FROM = {
				OR = {
					has_character_modifier = good_laboratory
					has_character_modifier = great_laboratory
					has_character_modifier = best_laboratory
				}
			}
		}
	}

	trigger = { has_quest = quest_dw_the_wizards_build_laboratory }

    option = { 
        name = EVTOPTA_MNM_1122

        clr_quest = quest_dw_the_wizards_find_apprentice

        if = {
        	limit = {
				FROM = {
					NOT = { has_character_modifier = good_laboratory }
					NOT = { has_character_modifier = great_laboratory }
					NOT = { has_character_modifier = best_laboratory }
				}
			}
 			add_society_currency_minor_effect = yes
        }
        if = {
        	limit = {
				FROM = {
					OR = {
						has_character_modifier = good_laboratory
						has_character_modifier = great_laboratory
					}
				}
			}
 			add_society_currency_medium_effect = yes
        }
		if = {
			limit = { FROM = { has_character_modifier = best_laboratory } }
			add_society_currency_major_effect = yes
		}
    }
}


#Mission: Find an apprentice
character_event = {
    id = DWSOC.1404
    hide_window = yes
    is_triggered_only = yes
    immediate = { FROM = { society_quest_event = { id = DWSOC.1405 days = 7 random = 7 } } }
}

society_quest_event = {
    id = DWSOC.1405
    desc = EVTDESC_MNM_1405

    is_triggered_only = yes
   
    option = {
		name = ACCEPT

		set_quest = quest_dw_the_wizards_find_apprentice

		hidden_effect = { character_event = { id = DWSOC.1406 days = 150 random = 50 } } 
	}

	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

#Still no apprentice? Make one
character_event = {
    id = DWSOC.1406
    hide_window = yes
    is_triggered_only = yes
    trigger = { has_quest = quest_dw_the_wizards_find_apprentice }
    immediate = { 
    	random_list = {
    		50 = {
    			modifier = {
    				is_female = no
    				factor = 1.5
    			}
    			create_random_priest = {
    				random_traits = yes
    				dynasty = none
    				female = yes
    				age = 28
    			}
    			new_character = {
    				save_event_target_as = apprentice_candidate
    			}
    		}
    		50 = {
    			modifier = {
    				is_female = yes
    				factor = 1.5
    			}
    			create_random_priest = {
    				random_traits = yes
    				dynasty = none
    				female = no
    				age = 28
    			}
    			new_character = {
    				save_event_target_as = apprentice_candidate
    			}
    		}
    	}

    	event_target:apprentice_candidate = {
    		remove_trait = slow
    		remove_trait = imbecile
    		remove_trait = inbred
    		remove_trait = dull
    		remove_trait = zealous
    		remove_trait = cynical
    		remove_trait = genius
    		remove_trait = quick
    		remove_trait = shrewd
    		remove_trait = slothful

    		#Add great trait
    		random_list = {
    			10 = { add_trait = genius }
    			10 = { add_trait = quick }
    			10 = { add_trait = shrewd }
    			10 = { trigger = { NOT = { religion_group = muslim } } add_trait = scholar }
    			10 = { trigger = { religion_group = muslim } add_trait = faqih }
    			10 = { add_trait = mystic }
    			10 = { add_trait = gardener }
    			10 = { trigger = { has_dlc = Reapers} add_trait = physician }
    			40 = { } #Nothing
    		}

    		#Add good trait 
    		random_list = {
    			10 = { add_trait = erudite }
    			10 = { add_trait = diligent }
    			10 = { 
    				add_trait = patient 
    				remove_trait = wroth
    			}
    			10 = {
    				add_trait = chaste
    				remove_trait = lustful
    			}
    			30 = {
    				add_trait = ambitious
    				remove_trait = content
    			}
    		}

    		while = {
    			limit = { NOT = { learning = 10 } }
    			change_learning = 1
    		}

    		character_event = { id = DWSOC.1407 }
    	}
    }
}

character_event = {
    id = DWSOC.1407
    hide_window = yes
    is_triggered_only = yes
    immediate = { FROM = { character_event = { id = DWSOC.1408 } } }
}

#What about this servant?
character_event = {
    id = DWSOC.1408
    desc = EVTDESC_MNM_1408
    picture = GFX_evt_experiment
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    immediate = {

    }

    option = { 
        name = EVTOPTA_MNM_1408

 		FROM = { give_minor_title = title_dw_the_wizards_apprentice }

 		clr_quest = quest_dw_the_wizards_find_apprentice
 		add_society_currency_minor_effect = yes
    }

    option = {
        name = EVTOPTB_MNM_1408
        custom_tooltip = { text = EVTOPTB_MNM_1408_TT }
    }
}

#You completed the quest by assigning someone the title
character_event = {
    id = DWSOC.1409
    desc = EVTDESC_MNM_1409
    picture = GFX_evt_experiment
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    option = { 
        name = EVTOPTA_MNM_1409

        clr_quest = quest_dw_the_wizards_find_apprentice

        if = {
        	limit = { FROM = { NOT = { learning = 12 } } }
 			add_society_currency_minor_effect = yes
        }
        if = {
        	limit = { FROM = { learning = 12 } }
 			add_society_currency_medium_effect = yes
        }
    }
}


##Clearing of flag
#character_event = {
#    id = DWSOC.1427
#    hide_window = yes
#    is_triggered_only = yes
#    immediate = { clr_character_flag = do_not_disturb }
#}


############
# POWERS
############
###Power: Happiness potion
#Gating event to check amount of/which ingredients used
character_event = {
    id = DWSOC.5115
    picture = GFX_evt_experiment
    border = GFX_event_normal_frame_religion
    is_triggered_only = yes

    desc = {
    	text = EVTDESC_MNM_5115_self
    	trigger = { has_character_flag = potion_target_is_self }
    }
    desc = {
    	text = EVTDESC_MNM_5115_other
    	trigger = { NOT = { has_character_flag = potion_target_is_self } }
    }

    immediate = {
    	#Selects two ingredients...
    	select_random_hermetic_ingredient_effect = yes
    	select_random_hermetic_ingredient_effect = yes
    }

    option = { # I will use ingredient 1
		name = {
        	text = EVTOPTA_MNM_5115_herb
        	trigger = { has_selected_herb_ingredient_1_trigger = yes }
        }
        name = {
        	text = EVTOPTA_MNM_5115_animal_part
        	trigger = { has_selected_animal_part_ingredient_1_trigger = yes }
        }		
        name = {
        	text = EVTOPTA_MNM_5115_powder
        	trigger = { has_selected_powder_ingredient_1_trigger = yes }
        }
        name = {
        	text = EVTOPTA_MNM_5115_liquid
        	trigger = { has_selected_liquid_ingredient_1_trigger = yes }
        }
		calculate_health_level_of_ingredient_1_effect = yes
		destroy_selected_ingredient_1_effect = yes

		ai_chance = { factor = 0 }

		trigger = {
			selected_ingredient_1_and_2_are_same = no
		}        
    }

	option = { # I will use ingredient 2
		name = {
        	text = EVTOPTB_MNM_5115_herb
        	trigger = { has_selected_herb_ingredient_2_trigger = yes }
        }
        name = {
        	text = EVTOPTB_MNM_5115_animal_part
        	trigger = { has_selected_animal_part_ingredient_2_trigger = yes }
        }		
        name = {
        	text = EVTOPTB_MNM_5115_powder
        	trigger = { has_selected_powder_ingredient_2_trigger = yes }
        }
        name = {
        	text = EVTOPTB_MNM_5115_liquid
        	trigger = { has_selected_liquid_ingredient_2_trigger = yes }
        }
		calculate_health_level_of_ingredient_2_effect = yes
        destroy_selected_ingredient_2_effect = yes

        ai_chance = { factor = 0 }
		
		trigger = {
        	has_selected_ingredient_2_trigger = yes
        	selected_ingredient_1_and_2_are_same = no
        }
    }

    option = { # I will only use one <ingredient_type_X> (IF DUPLICATE SELECTIONS)
		name = {
        	text = EVTOPTC_MNM_5115_herb
        	trigger = { has_selected_herb_ingredient_1_trigger = yes }
        }
        name = {
        	text = EVTOPTC_MNM_5115_animal_part
        	trigger = { has_selected_animal_part_ingredient_1_trigger = yes }
        }		
        name = {
        	text = EVTOPTC_MNM_5115_powder
        	trigger = { has_selected_powder_ingredient_1_trigger = yes }
        }
        name = {
        	text = EVTOPTC_MNM_5115_liquid
        	trigger = { has_selected_liquid_ingredient_1_trigger = yes }
        }
		calculate_health_level_of_ingredient_1_effect = yes
        destroy_selected_ingredient_1_effect = yes

        ai_chance = { factor = 0 }
		
		trigger = {
        	has_selected_ingredient_2_trigger = yes
        	selected_ingredient_1_and_2_are_same = yes
        }        
    }

    option = { #I will use ingredient 1 and 2
        name = {
        	text = EVTOPTD_MNM_5115
        	trigger = {	selected_ingredient_1_and_2_are_same = no }
        }
        name = {
        	text = EVTOPTD_MNM_5115_duplicate
        	trigger = {	selected_ingredient_1_and_2_are_same = yes }
        }

        calculate_health_level_of_ingredient_1_and_2_effect = yes
        
        destroy_selected_ingredient_1_and_2_effect = yes

        ai_chance = { factor = 25 }

        trigger = {
        	has_selected_ingredient_2_trigger = yes
        }
    }

    option = { #I'll throw a bit of everything in there!
        name = EVTOPTE_MNM_5115
        custom_tooltip = { text = EVTOPTE_MNM_5115_tt }

        calculate_health_level_of_all_ingredients_effect = yes

		destroy_all_ingredients_effect = yes

		ai_chance = { factor = 100 }

    	trigger = {
        	any_artifact = {
        		count = 4
        		has_artifact_flag = ingredient
        	}
        }
    }

    after = {
    	remove_selection_of_ingredients_effect = yes

    	hidden_effect = {
    		if = {
    			limit = { has_character_flag = potion_target_is_self }
    			character_event = { id = DWSOC.1400 days = 15 }
    		}
    		if = {
    			limit = { NOT = { has_character_flag = potion_target_is_self } }
    			clr_character_flag = preparing_potion
    			event_target:potion_target = { character_event = { id = DWSOC.1401 days = 10 } }
    		}
    		clr_character_flag = potion_target_is_self
    	}
    }
}

#Giving the potion to yourself
character_event = {
    id = DWSOC.1400
    desc = EVTDESC_MNM_1400
    picture = GFX_evt_experiment
    border = GFX_event_normal_frame_religion

    hide_from = yes

    is_triggered_only = yes
    
    option = { 
        name = EVTOPTA_MNM_1400

        if = { 
			limit = { trait = stressed }
			remove_trait = stressed
		}
		if = { 
			limit = { trait = depressed }
			remove_trait = depressed
		}
		if = {
			limit = { has_character_modifier = apathetic }
			remove_character_modifier = apathetic
		}

		hidden_effect = {
			clr_character_flag = preparing_potion
			random = {
				chance = 40
				modifier = {
					factor = 0.5
					check_variable = { which = current_potion_quality value = 1 }
				}
				modifier = {
					factor = 0.5
					check_variable = { which = current_potion_quality value = 2 }
				}
				modifier = {
					factor = 0.5
					check_variable = { which = current_potion_quality value = 4 }
				}
				modifier = {
					factor = 0.5
					check_variable = { which = current_potion_quality value = 6 }
				}
				modifier = {
					factor = 1.1
					NOT = { check_variable = { which = current_potion_quality value = -1 } }
				}
				modifier = {
					factor = 1.2
					NOT = { check_variable = { which = current_potion_quality value = -2 } }
				}
				modifier = {
					factor = 1.3
					NOT = { check_variable = { which = current_potion_quality value = -4 } }
				}
				modifier = {
					factor = 1.4
					NOT = { check_variable = { which = current_potion_quality value = -6 } }
				}
				character_event = { id = DWSOC.1403 days = 150 random = 600 }
			}

        	set_variable = { # Reset potion quality
    			which = current_potion_quality
    			value = 0
    		}
		} 
    }
}

#The other person gets offered a potion
character_event = {
    id = DWSOC.1401
    desc = EVTDESC_MNM_1401
    picture = GFX_evt_experiment
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
    
    option = { 
        name = EVTOPTA_MNM_1401
        custom_tooltip = { text = EVTOPTA_MNM_1401_TT }

        tooltip = {
	        if = { 
				limit = { trait = stressed }
				remove_trait = stressed
			}
			if = { 
				limit = { trait = depressed }
				remove_trait = depressed
			}
			if = {
				limit = { has_character_modifier = apathetic }
				remove_character_modifier = apathetic
			}
        }

		hidden_effect = { FROMFROM = { character_event = { id = DWSOC.1402 } } }

		ai_chance = {
			factor = 50
			modifier = {
				society_member_of = dw_the_wizards
				factor = 3
			}
		}
    }

    option = {
        name = EVTOPTB_MNM_1401
        custom_tooltip = { text = EVTOPTB_MNM_1401_TT }

        reverse_opinion = {
        	who = FROMFROM
        	modifier = opinion_ungrateful
        }
        #Does not give follow-up because if a player recieves this, the sender is a courtier

        ai_chance = {
			factor = 50
			modifier = {
				trait = zealous
				factor = 3
			}
			modifier = {
				liege = { character = FROMFROM } #A player will always get a yes
				factor = 0
			}
		}
    }
}


#Giving the potion to someone else 
character_event = {
    id = DWSOC.1402
    desc = EVTDESC_MNM_1402
    picture = GFX_evt_experiment
    border = GFX_event_normal_frame_religion

    hide_from = yes

    is_triggered_only = yes
    
    option = { 
        name = EVTOPTA_MNM_1402

        
    	FROM = {
	        if = { 
				limit = { trait = stressed }
				remove_trait = stressed
			}
			if = { 
				limit = { trait = depressed }
				remove_trait = depressed
			}
			if = {
				limit = { has_character_modifier = apathetic }
				remove_character_modifier = apathetic
			}

			hidden_effect = {
				random = {
					chance = 20
					modifier = {
						factor = 0.5
						ROOT = { check_variable = { which = current_potion_quality value = 1 } }
					}
					modifier = {
						factor = 0.5
						ROOT = { check_variable = { which = current_potion_quality value = 2 } }
					}
					modifier = {
						factor = 0.5
						ROOT = { check_variable = { which = current_potion_quality value = 4 } }
					}
					modifier = {
						factor = 0.5
						ROOT = { check_variable = { which = current_potion_quality value = 6 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { check_variable = { which = current_potion_quality value = -1 } } }
					}
					modifier = {
						factor = 1.2
						ROOT = { NOT = { check_variable = { which = current_potion_quality value = -2 } } }
					}
					modifier = {
						factor = 1.3
						ROOT = { NOT = { check_variable = { which = current_potion_quality value = -4 } } }
					}
					modifier = {
						factor = 1.4
						ROOT = { NOT = { check_variable = { which = current_potion_quality value = -6 } } }
					}
					character_event = { id = DWSOC.1403 days = 150 random = 600 }  
				}
			} 
    	}
        hidden_effect = {
        	set_variable = { # Reset potion quality
    			which = current_potion_quality
    			value = 0
    		}
    	}

        reverse_opinion = {
        	who = FROM
        	modifier = opinion_grateful
        }

    }
}

#The good effect didn't last
character_event = {
    id = DWSOC.1403
    desc = EVTDESC_MNM_1403
    picture = GFX_evt_illness
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    trigger = { NOT = { trait = depressed } }

    option = { 
        name = EVTOPTA_MNM_1403

        add_trait = depressed

        add_character_modifier = {
        	name = apathetic
        	years = 5
        }
    }
}

####################################################
# Wizard: Self Targeted Decision - Choose the mage trait or not
####################################################
# Chose whether or not to become a mage
narrative_event = {
	id = DWSOC.1900
	picture = a_placeholder
	title = dw_mage_choice_title
	desc = { # female
		trigger = {
			is_female = yes
		}
		text = DWSOC1900
		picture = wizard_female1
	}
	desc = { # male
		trigger = {
			NOT = { is_female = yes }
		}
		text = DWSOC1900
		picture = wizard_male1
	}
	is_triggered_only = yes # triggered by decision
	option = { # Choose to become a mage
		name = DWSOC1900A
		custom_tooltip = {
			text = DWSOC1900A_TOOLTIP
			narrative_event = { id = DWSOC.1902 days = 10 random = 20 }
		}
	}
	option = { # No to being a mage
		name = DWSOC1900B
		custom_tooltip = {
			text = DWSOC1900B_TOOLTIP
		}
		add_society_currency_minor_effect = yes
		clr_character_flag = dw_making_mage_trait_choice_flag
		set_character_flag = dw_declined_becoming_mage
	}
}

# Working on becoming a mage
narrative_event = {
	id = DWSOC.1902
	picture = a_placeholder
	title = dw_mage_choice_title
	desc = { # female
		trigger = {
			is_female = yes
		}
		text = DWSOC1902
		picture = wizard_meditate_female1
	}
	desc = { # male
		trigger = {
			NOT = { is_female = yes }
		}
		text = DWSOC1902
		picture = wizard_meditate_male1
	}
	is_triggered_only = yes
	option = { # Fire
		name = DWSOC1902A
		hidden_effect = {
			change_martial = 1 # Adds 1 to the martial score
			random_list = {
				25 = { change_intrigue = 1 } # +1 Intrigue
				25 = { change_learning = 1 } # +1 Learning
				25 = { change_stewardship = 1 } # +1 Stewardship
			}
			if = {
				limit = {
					trait = craven
				}
				remove_trait = craven
			}
			if = {
				limit = {
					NOT = { trait = brave }
				}
				add_trait = brave
			}
			if = {
				limit = {
					NOT = { trait = temperate }
					NOT = { trait = gluttonous }
				}
				add_trait = temperate # Overcoming the fire within requires amazing self-control
			}
			narrative_event = { id = DWSOC.1903 days = 1 }
		}
	}
	option = { # Ice
		name = DWSOC1902A
		hidden_effect = {
			health = +1.0
			random_list = {
				25 = { change_intrigue = 1 } # +1 Intrigue
				25 = { change_learning = 1 } # +1 Learning
				25 = { change_stewardship = 1 } # +1 Stewardship
			}
			if = {
				limit = {
					NOT = { trait = diligent }
					NOT = { trait = slothful }
				}
				add_trait = diligent # Slow and stead - like the encrouching winter
			}
			if = {
				limit = {
					NOT = { trait = chaste }
					NOT = { trait = lustful }
				}
				add_trait = chaste # Ice queen
			}
			narrative_event = { id = DWSOC.1903 days = 1 }
		}
	}
	option = { # Itch
		name = DWSOC1902C
		hidden_effect = {
			health = +1.0
			random_list = {
				25 = { change_intrigue = 1 } # +1 Intrigue
				25 = { change_learning = 1 } # +1 Learning
				25 = { change_stewardship = 1 } # +1 Stewardship
			}
			if = {
				limit = {
					trait = feeble
				}
				remove_trait = feeble
			}
			if = {
				limit = {
					NOT = { trait = robust }
				}
				add_trait = robust
			}
			if = {
				limit = {
					NOT = { trait = patient }
					NOT = { trait = wroth }
				}
				add_trait = patient # Resisting the need to try and scratch an itch requires amazing patience. 
			}
			narrative_event = { id = DWSOC.1903 days = 1 }
		}
	}
	option = { # Power
		name = DWSOC1902D
		custom_tooltip = {
			text = DWSOC1902D_TOOLTIP
		}
		hidden_effect = {
			random_list = {
				25 = { add_trait = lunatic }
				25 = { add_trait = possessed }
				25 = { add_trait = stutter }
			}
			if = {
				limit = {
					NOT = { trait = paranoid }
					NOT = { trait = trusting }
				}
				add_trait = paranoid
			}
			if = {
				limit = {
					trait = content
				}
				remove_trait = content
			}
			if = {
				limit = {
					NOT = { trait = ambitious }
				}
				add_trait = ambitious
			}
			change_intrigue = 1 # Add one to intrigue
			narrative_event = { id = DWSOC.1905 days = 1 }
		}
	}
}

# A new mage is born - safe method
narrative_event = {
	id = DWSOC.1903
	picture = a_placeholder
	title = dw_mage_choice_title
	desc = { # female
		trigger = {
			is_female = yes
		}
		text = DWSOC1903
		picture = wizard_female1
	}
	desc = { # male
		trigger = {
			NOT = { is_female = yes }
		}
		text = DWSOC1903
		picture = wizard_male1
	}
	is_triggered_only = yes
	option = { # My work is successful
		name = DWSOC1903A
		add_trait = mage
		clr_character_flag = dw_making_mage_trait_choice_flag
	}
}

# A new mage is born - risky method
narrative_event = {
	id = DWSOC.1905
	picture = a_placeholder
	title = dw_mage_choice_title
	desc = { # female
		trigger = {
			is_female = yes
		}
		text = DWSOC1905
		picture = wizard_insane_female1
	}
	desc = { # male
		trigger = {
			NOT = { is_female = yes }
		}
		text = DWSOC1905
		picture = wizard_insane_male1
	}
	is_triggered_only = yes
	
	option = { # My work is successful
		name = DWSOC1905A
		add_trait = mage
		clr_character_flag = dw_making_mage_trait_choice_flag
	}
}


################
# INTERACTIONS
################
#The flags hidden_lab and very_hidden_lab can be used for events about stealing secrets from others/having your secrets stolen.

#Interaction: Gathering of the Great Minds
character_event = {		
    id = DWSOC.1460
    desc = EVTDESC_MNM_1460
    picture = GFX_evt_gathering_of_minds
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
    
    trigger = {
    	society_member_of = dw_the_wizards
    	society_rank >= 2
    	learning = 10
    	OR = {
    		martial = 8
    		stewardship = 8
    	}
    	is_landed = yes
    	has_character_flag = built_laboratory
    	war = no
    	block_general_event_trigger = no
    	NOT = { has_character_flag = gathering_of_the_minds }
    	any_society_member = {
    		count = 4
    		opinion = { who = ROOT value = 15 }
			reverse_opinion = { who = ROOT value = 15 }
    	}
    }

    option = { 
        name = EVTOPTA_MNM_1460
        custom_tooltip = { text = EVTOPTA_MNM_1460_TT }
        scaled_wealth = { value = -0.5 min = -20 }
        hidden_effect = { 
        	character_event = { id = DWSOC.1461 days = 7 } 
        	set_character_flag = gathering_of_the_minds
        }
    }

    option = {
        name = EVTOPTB_MNM_1460
    }
}

#Send out letters
character_event = {
    id = DWSOC.1461
    desc = EVTDESC_MNM_1461
    picture = GFX_evt_recieve_letter
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
    hide_from = yes

    trigger = { has_character_flag =  gathering_of_the_minds }

    immediate = {
    	hidden_effect = {
	    	#Guest of honor (1)
	    	random_list = {
	    		50 = {
	    			trigger = { society = { any_society_member = { is_friend = ROOT  ai = yes } } }
	    			society = { random_society_member = { limit = { is_friend = ROOT ai = yes } save_event_target_as = great_minds_guest_1 } }
	    		} 
	    		50 = {
	    			trigger = { 
	    				society = { 
	    					any_society_member = { 
	    						ai = yes
	    						OR = {
	    							learning = 16
	    							society_rank == 4
	    						}
	    						is_within_diplo_range = ROOT
	    						opinion = { who = ROOT value = 20 }
	    						reverse_opinion = { who = ROOT value = 20 }
	    					}
	    				}
	    			}
	    			society = {
		    			random_society_member = {
		    				limit = {
		    					ai = yes
		    					OR = {
	    							learning = 16
	    							society_rank == 4
	    						}
	    						is_within_diplo_range = ROOT
	    						opinion = { who = ROOT value = 20 }
	    						reverse_opinion = { who = ROOT value = 20 }
		    				}
		    				save_event_target_as = great_minds_guest_1
		    			}
	    			}
	    		}
	    		1 = {
	    			society = {
				    	random_society_member = {
				    		limit = {
				    			ai = yes
				    			opinion = { who = ROOT value = 15 }
				    			reverse_opinion = { who = ROOT value = 15 }
				    		}
				    		save_event_target_as = great_minds_guest_1
				    	}
			    	}
	    		}
	    	}
    	}

    	#Guest 2
    	society = {
	    	random_society_member = {
	    		limit = {
	    			ai = yes
	    			NOT = { character = event_target:great_minds_guest_1 }
	    			opinion = { who = ROOT value = 15 }
	    			reverse_opinion = { who = ROOT value = 15 }
	    		}
	    		save_event_target_as = great_minds_guest_2
	    	}
    	}

    	#Guest 3 and 4
    	random_list = {
    		70 = { #Your rival gets invited
    			trigger = { society = { any_society_member = { ai = yes NOT = { reverse_opinion = { who = ROOT value = -30 } } } } }
    			set_character_flag = disliked_hermetic_colleague

    			society = {
    				random_society_member = {
    					limit = { ai = yes NOT = { reverse_opinion = { who = ROOT value = -30 } } }
    					save_event_target_as = great_minds_guest_4
    				}

    				random_society_member = {
						limit = {
							ai = yes
							opinion = { who = event_target:great_minds_guest_4 value = 20 }
							reverse_opinion = { who = ROOT value = 15 }
							NOR = {
								character = event_target:great_minds_guest_1
								character = event_target:great_minds_guest_2
							}
						}
						save_event_target_as = great_minds_guest_3
					}
    			}
    			if = {
    				limit = { NOT = { event_target:great_minds_guest_3 = { always = yes } } }
    				society = {
				    	random_society_member = {
				    		limit = {
				    			ai = yes
				    			NOR = {
									character = event_target:great_minds_guest_1
									character = event_target:great_minds_guest_2
								}
				    			opinion = { who = ROOT value = 15 }
				    			reverse_opinion = { who = ROOT value = 15 }
				    		}
				    		save_event_target_as = great_minds_guest_3
				    	}
			    	}
    			}
    		}
    		30 = { #Nothing special
    			society = {
			    	random_society_member = {
			    		limit = {
			    			ai = yes
			    			NOR = {
								character = event_target:great_minds_guest_1
								character = event_target:great_minds_guest_2
							}
			    			opinion = { who = ROOT value = 15 }
			    			reverse_opinion = { who = ROOT value = 15 }
			    		}
			    		save_event_target_as = great_minds_guest_3
			    	}
		    	}
		    	society = {
			    	random_society_member = {
			    		limit = {
			    			ai = yes
			    			NOR = {
								character = event_target:great_minds_guest_1
								character = event_target:great_minds_guest_2
								character = event_target:great_minds_guest_3
							}
			    			opinion = { who = ROOT value = 15 }
			    			reverse_opinion = { who = ROOT value = 15 }
			    		}
			    		save_event_target_as = great_minds_guest_4
			    	}
		    	}
    		}
    	}
    }

    option = { 
        name = EVTOPTA_MNM_1461

        reverse_opinion = { who = event_target:great_minds_guest_1 modifier = opinion_grateful_invitation months = 3 }
        reverse_opinion = { who = event_target:great_minds_guest_2 modifier = opinion_grateful_invitation months = 3 }
        reverse_opinion = { who = event_target:great_minds_guest_3 modifier = opinion_grateful_invitation months = 3 }
        if = {
        	limit = { NOT = { has_character_flag = disliked_hermetic_colleague } }
        	reverse_opinion = { who = event_target:great_minds_guest_4 modifier = opinion_grateful_invitation months = 3 }
        }
        hidden_effect = {
	        if = {
	        	limit = { has_character_flag = disliked_hermetic_colleague }
	        	event_target:great_minds_guest_3 = { character_event = { id = DWSOC.1462 days = 10 } }
	        	clr_character_flag = disliked_hermetic_colleague
	        	break = yes
	        }
	        character_event = { id = DWSOC.1464 days = 30 }
	    }
    }
}

#Ping to rival inviter
character_event = {
    id = DWSOC.1462
    hide_window = yes
    is_triggered_only = yes
    immediate = { FROM = { letter_event = { id = DWSOC.1463 } } }
}

#Another guests wants rival to come
letter_event = {
    id = DWSOC.1463
    desc = EVTDESC_MNM_1463
    border = GFX_event_letter_frame_religion

    is_triggered_only = yes

    trigger = { has_character_flag =  gathering_of_the_minds }
    
    #Diplomatic excuse
    option = {
    	trigger = { diplomacy = 12 }
    	tooltip_info = diplomacy
        name = EVTOPTD_MNM_1463
        custom_tooltip = { text = EVTOPTD_MNM_1463_TT }

        clear_event_target = great_minds_guest_4

    }

    #I guess they can come
  	option = { 
        name = EVTOPTA_MNM_1463
        custom_tooltip = { text = EVTOPTA_MNM_1463_TT }

        event_target:great_minds_guest_4 = {
        	set_character_flag = show_in_option
        	clr_character_flag = show_in_option
        }

        reverse_opinion = { who = FROM modifier = opinion_grateful years = 3 }
    }

    #I don't want them here
    option = {
        name = EVTOPTB_MNM_1463
        custom_tooltip = { text = EVTOPTB_MNM_1463_TT }

        clear_event_target = great_minds_guest_4

        hidden_effect = { character_event = { id = DWSOC.1480 } } #Handles scandals

        reverse_opinion = { who = FROM modifier = opinion_very_disappointed years = 3 }
    }
    
    #Neither are invited!
    option = {
        name = EVTOPTC_MNM_1463
        custom_tooltip = { text = EVTOPTC_MNM_1463_TT }

        clear_event_target = great_minds_guest_3
        clear_event_target = great_minds_guest_4

        set_character_flag = dw_the_wizards_minor_scandal #Will be upgraded to major in 1480
        hidden_effect = { character_event = { id = DWSOC.1480 } } #Handles scandals

        reverse_opinion = { who = FROM modifier = opinion_offended years = 10 }
    }

    after = {
    	hidden_effect = { character_event = { id = DWSOC.1464 days = 20 } }
    }
}

#You suggest what you make
character_event = {
    id = DWSOC.1464
    desc = EVTDESC_MNM_1464
    picture = GFX_evt_gathering_of_minds
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
    hide_from = yes

    trigger = { has_character_flag =  gathering_of_the_minds }

    #Something for war (handgun, giant crossbow, plate armor)
    option = { 
    	trigger = { martial = 8 }
    	tooltip_info = martial
        name = EVTOPTA_MNM_1464
        custom_tooltip = { text = EVTOPTA_MNM_1464_TT }
        set_character_flag = war_invention
    }

    #Something for prosperity (mill, compass, blast furnace)
    option = {
    	trigger = { stewardship = 8 }
    	tooltip_info = stewardship
        name = EVTOPTB_MNM_1464
        custom_tooltip = { text = EVTOPTB_MNM_1464_TT }
        set_character_flag = prosperity_invention
    }
    
    #Something for learning (glassess, cross staff, cipher disc)
    option = {
    	tooltip_info = learning
        name = EVTOPTD_MNM_1464
        custom_tooltip = { text = EVTOPTD_MNM_1464_TT }
        set_character_flag = knowledge_invention
    }

    after = {
    	hidden_effect = {
	    	random_list = { 
	    		50 = {
	    			trigger = {
	    				always = yes
	    				OR = {
	    					event_target:great_minds_guest_1 = { NOT = { opinion = { who = ROOT value = 10 } } }
	    					event_target:great_minds_guest_1 = { is_dumb_trigger = yes }
	    					event_target:great_minds_guest_1 = { trait = ambitious }
	    				}
	    			}
	    			modifier = { is_rival = event_target:great_minds_guest_1 factor = 3 }
	    			event_target:great_minds_guest_1 = { character_event = { id = DWSOC.1465 days = 3 } }
	    		}
	    		50 = {
	    			trigger = {
	    				always = yes
	    				OR = {
	    					event_target:great_minds_guest_2 = { NOT = { opinion = { who = ROOT value = 10 } } }
	    					event_target:great_minds_guest_2 = { is_dumb_trigger = yes }
	    					event_target:great_minds_guest_2 = { trait = ambitious }
	    				}
	    			}
	    			modifier = { is_rival = event_target:great_minds_guest_2 factor = 3 }
	    			event_target:great_minds_guest_2 = { character_event = { id = DWSOC.1465 days = 3 } }
	    		}
	    		50 = {
	    			trigger = {
	    				always = yes
	    				OR = {
	    					event_target:great_minds_guest_3 = { NOT = { opinion = { who = ROOT value = 10 } } }
	    					event_target:great_minds_guest_3 = { is_dumb_trigger = yes }
	    					event_target:great_minds_guest_3 = { trait = ambitious }
	    				}
	    			}
	    			modifier = { is_rival = event_target:great_minds_guest_3 factor = 3 }
	    			event_target:great_minds_guest_3 = { character_event = { id = DWSOC.1465 days = 3 } }
	    		}
	    		50 = {
	    			trigger = {
	    				always = yes
	    				OR = {
	    					event_target:great_minds_guest_4 = { NOT = { opinion = { who = ROOT value = 10 } } }
	    					event_target:great_minds_guest_4 = { is_dumb_trigger = yes }
	    					event_target:great_minds_guest_4 = { trait = ambitious }
	    				}
	    			}
	    			modifier = { is_rival = event_target:great_minds_guest_4 factor = 3 }
	    			event_target:great_minds_guest_4 = { character_event = { id = DWSOC.1465 days = 3 } }
	    		}
	    		50 = { #They agree
	    			character_event = { id = DWSOC.1467 days = 3 }
	    		}
	    	}
	    }
    }
}


#Someone protests (ping)
character_event = {
    id = DWSOC.1465
    hide_window = yes
    is_triggered_only = yes
    immediate = { FROM = { character_event = { id = DWSOC.1466 } } }
}
		
#Someone protests and has their own suggestion
character_event = {
    id = DWSOC.1466
    desc = EVTDESC_MNM_1466
    picture = GFX_evt_quarrel
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    trigger = { has_character_flag =  gathering_of_the_minds }
    
    immediate = {
    	FROM = {
	    	random_list = {
	    		33 = {
	    			trigger = { NOT = { ROOT = { has_character_flag = war_invention } } }
	    			modifier = { has_education_martial_trigger = yes factor = 1.5 }
	    			modifier = { has_lifestyle_martial_trigger = yes factor = 1.5 }
	    			set_character_flag = war_invention
	    		}
	    		33 = {
	    			trigger = { NOT = { ROOT = { has_character_flag = prosperity_invention } } }
	    			modifier = { has_education_stewardship_trigger = yes factor = 1.5 }
	    			modifier = { has_lifestyle_stewardship_trigger = yes factor = 1.5 }
	    			set_character_flag = prosperity_invention
	    		}
	    		33 = {
	    			trigger = { NOT = { ROOT = { has_character_flag = knowledge_invention } } }
	    			modifier = { has_education_learning_trigger = yes factor = 1.5 }
	    			modifier = { has_lifestyle_learning_trigger = yes factor = 1.5 }
	    			set_character_flag = knowledge_invention
	    		}
	    	}
    	}
    }

    #Debate them
    option = { 
    	trigger = { learning = 12 }
        name = EVTOPTA_MNM_1466
        custom_tooltip = { text = EVTOPTA_MNM_1466_TT }

        random_list = {
        	50 = { #You win
        		modifier = { learning = 8 factor = 1.2 }
        		modifier = { learning = 10 factor = 1.2 }
        		modifier = { learning = 12 factor = 1.2 }
        		modifier = { learning = 14 factor = 1.2 }
        		modifier = { learning = 16 factor = 1.2 }
        		modifier = { learning = 18 factor = 1.2 }
        		modifier = { learning = 20 factor = 1.2 }
        		custom_tooltip = { text = EVTOPTA_MNM_1466_SUCCESS_TT }
        		hidden_effect = { character_event = { id = DWSOC.1468 days = 7 } }
        	}
        	50 = { #They win
        		modifier = { FROM = { learning = 8 } factor = 1.2 }
        		modifier = { FROM = { learning = 10 } factor = 1.2 }
        		modifier = { FROM = { learning = 12 } factor = 1.2 }
        		modifier = { FROM = { learning = 14 } factor = 1.2 }
        		modifier = { FROM = { learning = 16 } factor = 1.2 }
        		modifier = { FROM = { learning = 18 } factor = 1.2 }
        		modifier = { FROM = { learning = 20 } factor = 1.2 }
        		custom_tooltip = { text = EVTOPTA_MNM_1466_FAILURE_TT }
        		hidden_effect = { character_event = { id = DWSOC.1469 days = 7 } }
        	}
        }
    }

    #Agree, it begins
    option = {
        name = EVTOPTB_MNM_1466
        custom_tooltip = { text = EVTOPTB_MNM_1466_TT }

        hidden_effect = {
        	clr_character_flag = war_invention
        	clr_character_flag = prosperity_invention
        	clr_character_flag = knowledge_invention

        	if = {
        		limit = { FROM = { has_character_flag = war_invention } }
        		FROM = { clr_character_flag = war_invention }
        		set_character_flag = war_invention
        	}
        	if = {
        		limit = { FROM = { has_character_flag = prosperity_invention } }
        		FROM = { clr_character_flag = prosperity_invention }
        		set_character_flag = prosperity_invention
        	}
        	if = {
        		limit = { FROM = { has_character_flag = knowledge_invention } }
        		FROM = { clr_character_flag = knowledge_invention }
        		set_character_flag = knowledge_invention
        	}
        }
        hidden_effect = { character_event = { id = DWSOC.1470 days = 30 } }
    }
    
    #Forbid, it begins
    option = {
        name = EVTOPTC_MNM_1466
        custom_tooltip = { text = EVTOPTC_MNM_1466_TT } 

        reverse_opinion = { who = event_target:great_minds_guest_1 modifier = opinion_unreasonable years = 5 }
        reverse_opinion = { who = event_target:great_minds_guest_2 modifier = opinion_unreasonable years = 5 }
        if = {
        	limit = { event_target:great_minds_guest_3 = { always = yes } }
        	reverse_opinion = { who = event_target:great_minds_guest_3 modifier = opinion_unreasonable years = 5 }
        }
        if = {
        	limit = { event_target:great_minds_guest_4 = { always = yes } }
        	reverse_opinion = { who = event_target:great_minds_guest_4 modifier = opinion_unreasonable years = 5 }
        }
        hidden_effect = { 	
       		character_event = { id = DWSOC.1480 } 
       		character_event = { id = DWSOC.1470 days = 30 }
       	}
       	FROM = {
        	clr_character_flag = war_invention
        	clr_character_flag = prosperity_invention
        	clr_character_flag = knowledge_invention
        }
    }
}	

#They agreed, it begins
character_event = {
    id = DWSOC.1467
    desc = EVTDESC_MNM_1467
    picture = GFX_evt_gathering_of_minds
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
    
    option = { 
        name = EVTOPTA_MNM_1467
        custom_tooltip = { text = EVTOPTA_MNM_1467_TT }

        hidden_effect = { character_event = { id = DWSOC.1470 days = 30 } }
    }
}	

#You won debate
character_event = {
    id = DWSOC.1468
    desc = EVTDESC_MNM_1468
    picture = GFX_evt_religious_exultation
    border = GFX_event_normal_frame_religion

    trigger = { has_character_flag =  gathering_of_the_minds }

    is_triggered_only = yes
    
    option = { 
        name = EVTOPTA_MNM_1468
        custom_tooltip = { text = EVTOPTA_MNM_1467_TT }

        add_society_currency_minor_effect = yes

        hidden_effect = { character_event = { id = DWSOC.1470 days = 30 } }

        FROMFROM = {
        	clr_character_flag = war_invention
        	clr_character_flag = prosperity_invention
        	clr_character_flag = knowledge_invention
        }
    }
}

#You lost debate
character_event = {
    id = DWSOC.1469
    desc = EVTDESC_MNM_1469
    picture = GFX_evt_rival_rulers
    border = GFX_event_normal_frame_religion

    trigger = { has_character_flag =  gathering_of_the_minds }

    is_triggered_only = yes
    
    option = { 
        name = EVTOPTA_MNM_1469
        custom_tooltip = { text = EVTOPTA_MNM_1469_TT }

        prestige = -50

        hidden_effect = {
        	clr_character_flag = war_invention
        	clr_character_flag = prosperity_invention
        	clr_character_flag = knowledge_invention

        	if = {
        		limit = { FROMFROM = { has_character_flag = war_invention } }
        		FROMFROM = { clr_character_flag = war_invention }
        		set_character_flag = war_invention
        	}
        	if = {
        		limit = { FROMFROM = { has_character_flag = prosperity_invention } }
        		FROMFROM = { clr_character_flag = prosperity_invention }
        		set_character_flag = prosperity_invention
        	}
        	if = {
        		limit = { FROMFROM = { has_character_flag = knowledge_invention } }
        		FROMFROM = { clr_character_flag = knowledge_invention }
        		set_character_flag = knowledge_invention
        	}
        }

       	hidden_effect = { character_event = { id = DWSOC.1470 days = 30 } }
    }
}

#Risky or safe project
character_event = {
    id = DWSOC.1470
    desc = EVTDESC_MNM_1470
    picture = GFX_evt_rival_rulers
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
    hide_from = yes

    trigger = { has_character_flag =  gathering_of_the_minds }

    #The safer
    option = { 
        name = EVTOPTA_MNM_1470
        custom_tooltip = { text = EVTOPTA_MNM_1470_TT }

        reverse_opinion = { who = event_target:great_minds_guest_2 modifier = opinion_grateful years = 5 }
        reverse_opinion = { who = event_target:great_minds_guest_1 modifier = opinion_disappointed years = 5 }

        hidden_effect = { set_character_flag = safe_invention }
    }

    #The riskier
    option = {
        name = EVTOPTB_MNM_1470
        custom_tooltip = { text = EVTOPTB_MNM_1470_TT }

      	reverse_opinion = { who = event_target:great_minds_guest_1 modifier = opinion_grateful years = 5 }
       	reverse_opinion = { who = event_target:great_minds_guest_2 modifier = opinion_disappointed years = 5 }

       	hidden_effect = { set_character_flag = risky_invention }
    }

    after = {
    	hidden_effect = {
    		event_target:great_minds_guest_1 = {
    			opinion = { who = event_target:great_minds_guest_1 modifier = opinion_argued years = 5 }
    			reverse_opinion = { who = event_target:great_minds_guest_1 modifier = opinion_argued years = 5 }
    		}

    		#Things that might happen
    		random_list = {
    			40 = { #People fight
    				trigger = {
    					society = {
    						any_society_member = {
    							OR = {
    								character = event_target:great_minds_guest_1
    								character = event_target:great_minds_guest_2
    								character = event_target:great_minds_guest_3
    								character = event_target:great_minds_guest_4
    							}
    							society = {
    								any_society_member = {
    									OR = {
		    								character = event_target:great_minds_guest_1
		    								character = event_target:great_minds_guest_2
		    								character = event_target:great_minds_guest_3
		    								character = event_target:great_minds_guest_4
		    							}
		    							NOT = { opinion = { who = PREVPREV value = 10 } }
    								}
    							}
    						}
    					}
    				}
    				society = {
    					random_society_member = {
    						limit = {
    							OR = {
    								character = event_target:great_minds_guest_1
    								character = event_target:great_minds_guest_2
    								character = event_target:great_minds_guest_3
    								character = event_target:great_minds_guest_4
    							}
    							society = {
    								any_society_member = {
    									OR = {
		    								character = event_target:great_minds_guest_1
		    								character = event_target:great_minds_guest_2
		    								character = event_target:great_minds_guest_3
		    								character = event_target:great_minds_guest_4
		    							}
		    							NOT = { opinion = { who = PREVPREV value = 10 } }
    								}
    							}
    						}
    						save_event_target_as = arguer_2
    						society = {
	    						random_society_member = {
	    							limit = {
	    								OR = {
		    								character = event_target:great_minds_guest_1
		    								character = event_target:great_minds_guest_2
		    								character = event_target:great_minds_guest_3
		    								character = event_target:great_minds_guest_4
		    							}
		    							NOT = { opinion = { who = PREVPREV value = 10 } }
	    							}
	    							save_event_target_as = arguer_1
	    						}
    						}
    					}
    				}
    				character_event = { id = DWSOC.1471 days = 20 random = 10 }
    			}
    			35 = { #You agree with someone
    				trigger = {
    					OR = {
    						opinion = { who = event_target:great_minds_guest_1 value = 20 }
    						opinion = { who = event_target:great_minds_guest_2 value = 20 }
    						opinion = { who = event_target:great_minds_guest_3 value = 20 }
    						opinion = { who = event_target:great_minds_guest_4 value = 20 }
    					}
    				}
    				society = {
    					random_society_member = {
    						limit = {
    							OR = {
    								character = event_target:great_minds_guest_1
    								character = event_target:great_minds_guest_2
    								character = event_target:great_minds_guest_3
    								character = event_target:great_minds_guest_4
    							}
    							reverse_opinion = { who = ROOT value = 20 }
    						}
    						character_event = { id = DWSOC.1474 days = 20 random = 10 }
    					}
    				}
    			}
    			25 = { #You have a brilliant insight
    				trigger = { learning = 12 }
    				modifier = { learning = 14 factor = 1.2 }
    				modifier = { learning = 16 factor = 1.2 }
    				modifier = { learning = 18 factor = 1.2 }
    				modifier = { has_character_modifier = divine_summoning_succeeded factor = 1.5 }
    				character_event = { id = DWSOC.1476 days = 20 random = 10 }
    			}
    		}
    	}
    }
}


#Two people are arguing
character_event = {
    id = DWSOC.1471
    desc = EVTDESC_MNM_1471
    picture = GFX_evt_quarrel
    border = GFX_event_normal_frame_war

    is_triggered_only = yes
    hide_from = yes

    trigger = { has_character_flag =  gathering_of_the_minds }

    #Try to meddle
    option = { 
        name = EVTOPTA_MNM_1471
        custom_tooltip = { text = EVTOPTA_MNM_1471_TT }

        random_list = {
        	50 = { #It works
        		modifier = { society_rank >= 3 factor = 1.2 }
        		modifier = { 
        			reverse_opinion = { who = event_target:arguer_1 value = 25 }
        			reverse_opinion = { who = event_target:arguer_2 value = 25 } 
        			factor = 1.4
        		}
        		modifier = { diplomacy = 12 factor = 1.2 }
        		modifier = { diplomacy = 14 factor = 1.2 }
        		modifier = { diplomacy = 16 factor = 1.2 }
        		custom_tooltip = { text = EVTOPTA_MNM_1471_SUCCESS_TT }
        		hidden_effect = { character_event = { id = DWSOC.1472 days = 5 } }
        	}
        	50 = { #It didn't work
        		modifier = { NOT = { diplomacy = 10 } factor = 1.2 }
        		modifier = { has_unpleasant_personality_trigger = yes factor = 1.3 }
        		custom_tooltip = { text = EVTOPTA_MNM_1471_FAIL_TT }
        		hidden_effect = { character_event = { id = DWSOC.1473 days = 5 } }
        	}
        }
    }

    #Person 1 goes
    option = {
        name = EVTOPTB_MNM_1471
        custom_tooltip = { text = EVTOPTB_MNM_1471_TT }

        hidden_effect = {

        	hidden_effect = { character_event = { id = DWSOC.1480 } } #Handles scandals


    		#After some time, end result
    		character_event = { id = DWSOC.1477 days = 30 random = 20 }
        }
    }
    
    #Person 2 goes
    option = {
        name = EVTOPTC_MNM_1471
        custom_tooltip = { text = EVTOPTC_MNM_1471_TT }

        hidden_effect = {
        	hidden_effect = { character_event = { id = DWSOC.1480 } } #Handles scandals

    		#After some time, end result
    		character_event = { id = DWSOC.1477 days = 30 random = 20 }
        }
    }
}

#You managed to make the quarrelers make up
character_event = {
    id = DWSOC.1472
    desc = EVTDESC_MNM_1472
    picture = GFX_evt_state_diplomacy
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    trigger = { has_character_flag =  gathering_of_the_minds }

    option = { 
        name = EVTOPTA_MNM_1472
        custom_tooltip = { text = EVTOPTA_MNM_1472_TT }

        reverse_opinion = {
        	who =  event_target:arguer_1
        	modifier = opinion_reasonable
        	years = 5
        }

        reverse_opinion = {
        	who =  event_target:arguer_2
        	modifier = opinion_reasonable
        	years = 5
        }


    	hidden_effect = {
    		#After some time, end result
    		character_event = { id = DWSOC.1477 days = 30 random = 20 }
    	}
    }
}

#You fail to make the quarrelers make up
character_event = {
    id = DWSOC.1473
    desc = EVTDESC_MNM_1473
    picture = GFX_evt_rival_rulers
    border = GFX_event_normal_frame_war

    is_triggered_only = yes

    trigger = { has_character_flag =  gathering_of_the_minds }

    option = { 
        name = EVTOPTA_MNM_1473
        custom_tooltip = { text = EVTOPTA_MNM_1473_TT }

        reverse_opinion = {
        	who =  event_target:arguer_1
        	modifier = opinion_unreasonable
        	years = 5
        }

        reverse_opinion = {
        	who =  event_target:arguer_2
        	modifier = opinion_unreasonable
        	years = 5
        }

        hidden_effect = {
        	#No one leaves because it is sure to end here

        	clr_character_flag = dw_the_wizards_minor_scandal
        	set_character_flag = dw_the_wizards_major_scandal
        	hidden_effect = { character_event = { id = DWSOC.1480 } } #Handles scandals

    		#After some time, end result
    		character_event = { id = DWSOC.1477 days = 30 random = 20 }
        }
    }
}

#You agree with someone (ping)
character_event = {
    id = DWSOC.1474
    hide_window = yes
    is_triggered_only = yes
    immediate = { FROM = { character_event = { id = DWSOC.1475 } } }
}

#You agree with someone, you work well together
character_event = {
    id = DWSOC.1475
    desc = EVTDESC_MNM_1475
    picture = GFX_evt_experiment
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    trigger = { has_character_flag = gathering_of_the_minds }
    
    option = { 
        name = EVTOPTA_MNM_1475

        hidden_effect = {
        	#After some time, end result
    		character_event = { id = DWSOC.1477 days = 30 random = 20 }
        }

        if = {
        	limit = {
        		opinion = { who = FROM value = 40 }
        		reverse_opinion = { who = FROM value = 40 }
        		NOT = { is_friend = FROM }
        	}
        	add_friend = FROM
        	break = yes
        }
        reverse_opinion = {
        	who = FROM
        	modifier = opinion_great_minds
        	years = 10 
        }
        hidden_effect = {
        	opinion = {
	        	who = FROM
	        	modifier = opinion_great_minds
	        	years = 10 
	        }
        }
    }
}

#You have a brilliant insight		
character_event = {
    id = DWSOC.1476
    desc = EVTDESC_MNM_1476
    picture = GFX_evt_religious_exultation
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    hide_from = yes

    trigger = { has_character_flag =  gathering_of_the_minds }

    option = { 
        name = EVTOPTA_MNM_1476
        custom_tooltip = { text = EVTOPTA_MNM_1476_TT }

        add_character_modifier = {
        	name = brilliant_insight
        	years = 5
        }

        set_character_flag = brilliant_insight


    	hidden_effect = {
    		#After some time, end result
    		character_event = { id = DWSOC.1477 days = 30 random = 20 }
    	}
    }
}

#Event to calculate outcome
character_event = {
    id = DWSOC.1477
    hide_window = yes
    is_triggered_only = yes
    trigger = { has_character_flag =  gathering_of_the_minds }
    immediate = {
    	#Adds up everyone's learning
    	set_variable = { which = collective_learning value = 0 }
    	if = {
    		limit = { event_target:great_minds_guest_1 = { always = yes } }
    		export_to_variable = { which = collective_learning_temp value = learning who = event_target:great_minds_guest_1 }
    		change_variable = { which = collective_learning which = collective_learning_temp }
    	}
    	if = {
    		limit = { event_target:great_minds_guest_2 = { always = yes } }
    		export_to_variable = { which = collective_learning_temp value = learning who = event_target:great_minds_guest_2 }
    		change_variable = { which = collective_learning which = collective_learning_temp }
    	}
    	if = {
    		limit = { event_target:great_minds_guest_3 = { always = yes } }
    		export_to_variable = { which = collective_learning_temp value = learning who = event_target:great_minds_guest_3 }
    		change_variable = { which = collective_learning which = collective_learning_temp }
    	}
    	if = {
    		limit = { event_target:great_minds_guest_4 = { always = yes } }
    		export_to_variable = { which = collective_learning_temp value = learning who = event_target:great_minds_guest_4 }
    		change_variable = { which = collective_learning which = collective_learning_temp }
    	}


    	#Outcome
    	random_list = {
    		20 = { #Best
    			trigger = { has_character_flag = risky_invention }
    			modifier = { learning = 10 factor = 1.3 }
    			modifier = { learning = 12 factor = 1.3 }
    			modifier = { learning = 14 factor = 1.3 }
    			modifier = { learning = 16 factor = 1.3 }
    			modifier = { learning = 18 factor = 1.3 }
    			modifier = { learning = 20 factor = 1.3 }
    			modifier = { has_character_flag = brilliant_insight factor = 100 }
    			modifier = { check_variable = { which = collective_learning value = 40 } factor = 1.4 }
    			modifier = { check_variable = { which = collective_learning value = 50 } factor = 1.4 }
    			modifier = { check_variable = { which = collective_learning value = 60 } factor = 1.4 }
    			set_character_flag = best_outcome
    			character_event = { id = DWSOC.1478 }
    		}
    		30 = { #Good
    			modifier = { learning = 10 factor = 1.2 }
    			modifier = { learning = 12 factor = 1.2 }
    			modifier = { learning = 14 factor = 1.2 }
    			modifier = { learning = 16 factor = 1.2 }
    			modifier = { learning = 18 factor = 1.2 }
    			modifier = { learning = 20 factor = 1.2 }
    			modifier = { has_character_flag = brilliant_insight factor = 10 }
    			modifier = { check_variable = { which = collective_learning value = 40 } factor = 1.3 }
    			modifier = { check_variable = { which = collective_learning value = 50 } factor = 1.3 }
    			modifier = { check_variable = { which = collective_learning value = 60 } factor = 1.3 }
    			set_character_flag = good_outcome
    			character_event = { id = DWSOC.1478 }
    		}
    		45 = { #Ok
    			trigger = { has_character_flag = safe_invention }
    			modifier = { learning = 10 factor = 1.1 }
    			modifier = { learning = 12 factor = 1.1 }
    			modifier = { learning = 14 factor = 1.1 }
    			modifier = { learning = 16 factor = 1.1 }
    			modifier = { learning = 18 factor = 1.1 }
    			modifier = { learning = 20 factor = 1.1 }
    			modifier = { check_variable = { which = collective_learning value = 40 } factor = 1.2 }
    			modifier = { check_variable = { which = collective_learning value = 50 } factor = 1.2 }
    			modifier = { check_variable = { which = collective_learning value = 60 } factor = 1.2 }
    			set_character_flag = ok_outcome
    			character_event = { id = DWSOC.1478 }
    		}
    		25 = { #Normal failure outcome 
    			trigger = { has_character_flag = safe_invention }
    			set_character_flag = failure_outcome
    			character_event = { id = DWSOC.1479 }
    		}
    		25 = { #Dangerous failure outcome
    			trigger = { has_character_flag = risky_invention }
    			set_character_flag = bad_failure_outcome
    			character_event = { id = DWSOC.1479 }
    		}
    	}
    	clr_character_flag = brilliant_insight
    	#Select a target province for modifiers todo
    }
}

#Good outcome
character_event = {
    id = DWSOC.1478
    picture = GFX_evt_gathering_of_minds
    border = GFX_event_normal_frame_religion

    desc = {
    	trigger = {
    		has_character_flag = best_outcome
    		has_character_flag = war_invention
    	}
    	text = EVTDESC_MNM_1478_A #Hand gun
    	picture = GFX_evt_gathering_of_minds
    }
    desc = {
    	trigger = {
    		has_character_flag = best_outcome 
    		has_character_flag = prosperity_invention
    	}
    	text = EVTDESC_MNM_1478_B #Compass
    	picture = GFX_evt_gathering_of_minds
    }
    desc = {
    	trigger = {
    		has_character_flag = best_outcome 
    		has_character_flag = knowledge_invention
    	}
    	text = EVTDESC_MNM_1478_C #Radius astronomicus
    	picture = GFX_evt_gathering_of_minds
    }
    desc = {
    	trigger = {
    		has_character_flag = good_outcome
    		has_character_flag = war_invention 
    	}
    	text = EVTDESC_MNM_1478_D #Giant crossbow
    	picture = GFX_evt_gathering_of_minds
    }
    desc = {
    	trigger = {
    		has_character_flag = good_outcome 
    		has_character_flag = prosperity_invention
    	}
    	text = EVTDESC_MNM_1478_E #Blast furnace
    	picture = GFX_evt_weaponsmith
    }
    desc = {
    	trigger = {
    		has_character_flag = good_outcome 
    		has_character_flag = knowledge_invention
    	}
    	text = EVTDESC_MNM_1478_F #Crypt and cypher machine
    	picture = GFX_evt_ritual_scroll
    }
    desc = {
    	trigger = {
    		has_character_flag = ok_outcome
    		has_character_flag = war_invention
    	}
    	text = EVTDESC_MNM_1478_G  #Plate armor
    	picture = GFX_evt_weaponsmith
    }
    desc = {
    	trigger = {
    		has_character_flag = ok_outcome 
    		has_character_flag = prosperity_invention
    	}
    	text = EVTDESC_MNM_1478_H #A new mill
    	picture = GFX_evt_gathering_of_minds
    }
    desc = {
    	trigger = {
    		has_character_flag = ok_outcome
    		has_character_flag = knowledge_invention
    	}
    	text = EVTDESC_MNM_1478_I #Glasses
    	picture = GFX_evt_gathering_of_minds
    }

    is_triggered_only = yes
    hide_from = yes
    
   	trigger = { has_character_flag =  gathering_of_the_minds }

    option = { 
    	trigger = {
    		has_character_flag = best_outcome
    		has_character_flag = war_invention
    	}
        name = EVTOPTA_MNM_1478

        add_artifact = hermetic_handgun

        military_techpoints = 100
        add_society_currency_major_effect = yes
    }

    option = {
    	trigger = {
    		has_character_flag = best_outcome
    		has_character_flag = prosperity_invention
    	}
        name = EVTOPTB_MNM_1478

       	add_artifact = hermetic_compass

        economy_techpoints = 100
        add_society_currency_major_effect = yes
    }
    
    option = {
    	trigger = {
    		has_character_flag = best_outcome
    		has_character_flag = knowledge_invention
    	}
        name = EVTOPTC_MNM_1478

        add_artifact = radius_astronomicus

        culture_techpoints = 100
        add_society_currency_major_effect = yes
    }
    
    option = {
    	trigger = {
    		has_character_flag = good_outcome
    		has_character_flag = war_invention
    	}
        name = EVTOPTD_MNM_1478

    	capital_scope = {
        	add_province_modifier = {
        		name = giant_crossbow
        		years = 100
        	}
        }

        military_techpoints = 50
      	add_society_currency_medium_effect = yes
    }

    option = {
    	trigger = {
    		has_character_flag = good_outcome
    		has_character_flag = prosperity_invention
    	}
        name = EVTOPTE_MNM_1478

        capital_scope = {
        	add_province_modifier = {
        		name = blast_furnace
        		years = 100
        	}
        }

        economy_techpoints = 50
      	add_society_currency_medium_effect = yes
    }

    option = {
    	trigger = {
    		has_character_flag = good_outcome
    		has_character_flag = knowledge_invention
    	}
        name = EVTOPTF_MNM_1478

        add_artifact = hermetic_cypher_machine

        culture_techpoints = 50
      	add_society_currency_medium_effect = yes
    }

    option = {
    	trigger = {
    		has_character_flag = ok_outcome
    		has_character_flag = war_invention
    	}
        name = EVTOPTG_MNM_1478

    	add_artifact = hermetic_plate_armor

    	military_techpoints = 25
      	add_society_currency_minor_effect = yes
    }

    option = {
    	trigger = {
    		has_character_flag = ok_outcome
    		has_character_flag = prosperity_invention
    	}
        name = EVTOPTH_MNM_1478

        capital_scope = {
        	add_province_modifier = {
        		name = great_mill
        		years = 100
        	}
        }

        economy_techpoints = 25
      	add_society_currency_minor_effect = yes
    }

    option = {
    	trigger = {
    		has_character_flag = ok_outcome
    		has_character_flag = knowledge_invention
    	}
        name = EVTOPTI_MNM_1478

        add_artifact = hermetic_glasses

        culture_techpoints = 25
      	add_society_currency_minor_effect = yes
    }

    after = {
    	hidden_effect = {
    		clr_character_flag = gathering_of_the_minds
    		clr_character_flag = war_invention
    		clr_character_flag = prosperity_invention
    		clr_character_flag = knowledge_invention
    		clr_character_flag = great_outcome
    		clr_character_flag = good_outcome
    		clr_character_flag = ok_outcome
    	}
    }
}

#Failure
character_event = {
    id = DWSOC.1479
    picture = GFX_evt_burning_house
    border = GFX_event_normal_frame_religion

    desc = {
    	trigger = { has_character_flag = failure_outcome }
    	text = EVTDESC_MNM_1479_A
    	picture = GFX_evt_quarrel
    }
    desc = {
    	trigger = { has_character_flag = bad_failure_outcome }
    	text = EVTDESC_MNM_1479_B
    }

    immediate = {
    	random_list = {
			20 = { set_character_flag = invention_failure_maimed }
			20 = { set_character_flag = invention_failure_wounded }
			60 = { } #They're safe
    	}
    	event_target:great_minds_guest_1 = {
    		random_list = {
    			20 = { set_character_flag = invention_failure_death }
    			20 = { set_character_flag = invention_failure_maimed }
    			20 = { set_character_flag = invention_failure_wounded }
    			40 = { } #They're safe
    		}
    	}
    	event_target:great_minds_guest_2 = {
    		random_list = {
    			20 = { set_character_flag = invention_failure_death }
    			20 = { set_character_flag = invention_failure_maimed }
    			20 = { set_character_flag = invention_failure_wounded }
    			40 = { } #They're safe
    		}
    	}
    	event_target:great_minds_guest_3 = {
    		random_list = {
    			20 = { set_character_flag = invention_failure_death }
    			20 = { set_character_flag = invention_failure_maimed }
    			20 = { set_character_flag = invention_failure_wounded }
    			40 = { } #They're safe
    		}
    	}
    	event_target:great_minds_guest_4 = {
    		random_list = {
    			20 = { set_character_flag = invention_failure_death }
    			20 = { set_character_flag = invention_failure_maimed }
    			20 = { set_character_flag = invention_failure_wounded }
    			40 = { } #They're safe
    		}
    	}
    }

    is_triggered_only = yes

    hide_from = yes

    option = { 
    	trigger = { has_character_flag = failure_outcome }
        name = EVTOPTA_MNM_1479
        custom_tooltip = { text = EVTOPTA_MNM_1479_TT }
    }

    option = {
    	trigger = { has_character_flag = bad_failure_outcome }
        name = EVTOPTB_MNM_1479
        custom_tooltip = { text = EVTOPTB_MNM_1479_TT }

        trigger_switch = {
	        on_trigger = has_character_flag
	        invention_failure_maimed	= { add_maimed_trait_effect = yes }
	        invention_failure_wounded	= { add_trait_silently_wounded_effect = yes }
        }

        event_target:great_minds_guest_1 = {
        	trigger_switch = {
		        on_trigger = has_character_flag
		       	invention_failure_death 	= { death = { death_reason = death_accident } }
		        invention_failure_maimed	= { add_maimed_trait_effect = yes }
		        invention_failure_wounded	= { add_trait_silently_wounded_effect = yes }
	        }
        }
        event_target:great_minds_guest_2 = {
        	trigger_switch = {
		        on_trigger = has_character_flag
		       	invention_failure_death 	= { death = { death_reason = death_accident } }
		        invention_failure_maimed	= { add_maimed_trait_effect = yes }
		        invention_failure_wounded	= { add_trait_silently_wounded_effect = yes }
	        }
        }
        event_target:great_minds_guest_3 = {
        	trigger_switch = {
		        on_trigger = has_character_flag
		       	invention_failure_death 	= { death = { death_reason = death_accident } }
		        invention_failure_maimed	= { add_maimed_trait_effect = yes }
		        invention_failure_wounded	= { add_trait_silently_wounded_effect = yes }
	        }
        }
        event_target:great_minds_guest_4 = {
        	trigger_switch = {
		        on_trigger = has_character_flag
		       	invention_failure_death 	= { death = { death_reason = death_accident } }
		        invention_failure_maimed	= { add_maimed_trait_effect = yes }
		        invention_failure_wounded	= { add_trait_silently_wounded_effect = yes }
	        }
        }
    }

    after = {
    	hidden_effect = {
    		clr_character_flag = gathering_of_the_minds
    		clr_character_flag = war_invention
    		clr_character_flag = prosperity_invention
    		clr_character_flag = knowledge_invention
    		clr_character_flag = failure_outcome
    		clr_character_flag = bad_failure_outcome

    		clr_character_flag = invention_failure_maimed
    		clr_character_flag = invention_failure_wounded
    		event_target:great_minds_guest_1 = {
    			clr_character_flag = invention_failure_maimed
    			clr_character_flag = invention_failure_wounded
    		}
    		event_target:great_minds_guest_2 = {
    			clr_character_flag = invention_failure_maimed
    			clr_character_flag = invention_failure_wounded
    		}
    		event_target:great_minds_guest_3 = {
    			clr_character_flag = invention_failure_maimed
    			clr_character_flag = invention_failure_wounded
    		}
    		event_target:great_minds_guest_4 = {
    			clr_character_flag = invention_failure_maimed
    			clr_character_flag = invention_failure_wounded
    		}
    	}
    }
}

#Handles scandals, ends the event chain if things go to far
character_event = {
    id = DWSOC.1480
    hide_window = yes
    is_triggered_only = yes
    trigger = { has_character_flag =  gathering_of_the_minds }
    immediate = {
    	if = {
	    	limit = {
	    		NOR = {
	    			has_character_flag = dw_the_wizards_minor_scandal
	    			has_character_flag = dw_the_wizards_major_scandal
	    		}
	    	}
	    	set_character_flag = dw_the_wizards_minor_scandal
	    	break = yes
    	} 
    	if = {
    		limit = { has_character_flag = dw_the_wizards_minor_scandal }
    		clr_character_flag = dw_the_wizards_minor_scandal
    		set_character_flag = dw_the_wizards_major_scandal
    		break = yes
    	}

    	if = {
    		limit = { has_character_flag = dw_the_wizards_major_scandal }
    		clr_character_flag = dw_the_wizards_major_scandal

    		character_event	= { id = DWSOC.1481 }
    	}
    }
}

character_event = {
    id = DWSOC.1481
    desc = EVTDESC_MNM_1481
    picture = GFX_evt_scandal
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
    hide_from = yes
    
    option = { 
        name = EVTOPTA_MNM_1481
        custom_tooltip = { text = EVTOPTA_MNM_1481_TT }

        hidden_effect = {
        	clr_character_flag = gathering_of_the_minds
        	clr_character_flag = war_invention
        	clr_character_flag = prosperity_invention
        	clr_character_flag = knowledge_invention
        	clr_character_flag = dw_the_wizards_minor_scandal
        	clr_character_flag = dw_the_wizards_major_scandal
        	clr_character_flag = risky_invention
        	clr_character_flag = safe_invention
        	clr_character_flag = brilliant_insight

        	event_target:great_minds_guest_1 = {
        		clr_character_flag = war_invetion
        		clr_character_flag = prosperity_invention
        		clr_character_flag = knowledge_invention
        	}
        	event_target:great_minds_guest_2 = {
        		clr_character_flag = war_invetion
        		clr_character_flag = prosperity_invention
        		clr_character_flag = knowledge_invention
        	}
        	event_target:great_minds_guest_3 = {
        		clr_character_flag = war_invetion
        		clr_character_flag = prosperity_invention
        		clr_character_flag = knowledge_invention
        	}
        	event_target:great_minds_guest_4 = {
        		clr_character_flag = war_invetion
        		clr_character_flag = prosperity_invention
        		clr_character_flag = knowledge_invention
        	}
        }
    }
}	


##Divine Summoning##

#Divine Summoning find target ping
character_event = {
	id = DWSOC.1620
	hide_window = yes
	
	is_triggered_only = yes
	
	only_playable = yes
	only_capable = yes
	prisoner = no
	is_in_society = yes
	
	trigger = {
		society_member_of = dw_the_wizards
		NOT = { is_inaccessible_trigger = yes }
	}
	
	weight_multiplier = {
		factor = 1
		modifier = {
			factor = 2.0
			society_rank >= 3
		}
		modifier = {
			factor = 0.5
			society_rank == 1
		}
		modifier = {
			factor = 3.0
			OR = {
				has_focus = focus_scholarship
				has_focus = focus_theology
			}
		}
		modifier = {
			factor = 3.0
			trait = genius
		}
		modifier = {
			factor = 3.0
			trait = mystic
		}
		modifier = {
			factor = 2.0
			trait = quick
		}
		modifier = {
			factor = 2.0
			trait = shrewd
		}
		modifier = {
			factor = 0.5
			trait = dull
		}
		modifier = {
			factor = 0.5
			trait = slow
		}
		modifier = {
			factor = 0.1
			trait = imbecile
		}
		modifier = {
			factor = 0.25
			has_character_flag = had_a_divine_summoning
		}
	}
	
	immediate = {
		# First look for someone at court
		society = {
			random_society_member = {
				limit = {
					ai = yes
					is_incapable = no
					prisoner = no
					NOT = { is_inaccessible_trigger = yes }
					NOT = { character = ROOT }
					in_command = no
					host = { character = ROOT }
				}
				character_event = { id = DWSOC.1621 }
				break = yes
			}
			
			# Then look for someone in the same realm
			random_society_member = {
				limit = {
					ai = yes
					is_incapable = no
					prisoner = no
					NOT = { is_inaccessible_trigger = yes }
					NOT = { character = ROOT }
					in_command = no
					same_realm = ROOT
				}
				character_event = { id = DWSOC.1621 }
				break = yes
			}
			
			# Then look abroad...
			random_society_member = {
				limit = {
					ai = yes
					is_incapable = no
					prisoner = no
					NOT = { is_inaccessible_trigger = yes }
					NOT = { character = ROOT }
					in_command = no
					is_within_diplo_range = ROOT
				}
				character_event = { id = DWSOC.1621 }
			}
		}
	}
}

# Bounce
character_event = {
	id = DWSOC.1621
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		FROM = { character_event = { id = DWSOC.1622 } }
	}
}

# Divine Summoning - Planning
character_event = {
	id = DWSOC.1622
	picture = GFX_evt_shadowy_cabal
	border = GFX_event_normal_frame_religion
	
	desc = {
		text = EVTDESC_MNM_1622
		trigger = {
			FROM = {
				NOT = { host = { character = ROOT } }
			}
		}
	}
	desc = {
		text = EVTDESC_MNM_1622_COURT
		trigger = {
			FROM = {
				host = { character = ROOT }
			}
		}
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_1622 # Anything to grow closer to the Divine!
		ai_chance = {
			factor = 100
			modifier = {
				factor = 50
				trait = ambitious
			}
			modifier = {
				factor = 50
				trait = mystic
			}
			modifier = {
				factor = 0
				any_artifact = {
					has_artifact_flag = ingredient
				}
			}
		}
		
		set_character_flag = had_a_divine_summoning
		
		FROM = { character_event = { id = DWSOC.1623 tooltip = EVT_TT_1622 } }
	}

	option = {
		name = EVTOPTA_MNM_1622_use_ingredients # Send them these ingredients to aid in the ritual!
		tooltip_info = yes
        custom_tooltip = { text = ingredient_option_available_tt }

		ai_chance = {
			factor = 500
			modifier = {
				factor = 50
				trait = ambitious
			}
			modifier = {
				factor = 50
				trait = mystic
			}
		}

		custom_tooltip = {
			text = ingredients_are_sent_tt
			hidden_effect = { destroy_random_ingredients_effect = yes }
		}

		
		set_character_flag = had_a_divine_summoning
		set_character_flag = used_ingredients_for_summoning
		
		FROM = { character_event = { id = DWSOC.1623 } }

		trigger = {
			any_artifact = {
				has_artifact_flag = ingredient
			}
		}
	}

	option = {
		name = EVTOPTB_MNM_1622 # Even rituals carry danger
		ai_chance = {
			factor = 1
			modifier = {
				factor = 50
				trait = craven
			}
			modifier = {
				factor = 25
				trait = content
			}
		}
		
		detract_society_currency_minor_effect = yes
		reverse_opinion = { who = FROM modifier = opinion_coward years = 5 }
	}
}

# Bounce
character_event = {
	id = DWSOC.1623
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		destroy_random_ingredients_effect = yes
		FROM = { narrative_event = { id = DWSOC.1624 days = 15 random = 15  } }
	}
}

# Divine Summoning - The Ritual
narrative_event = {
	id = DWSOC.1624
	picture = GFX_evt_magic_ritual
	border = GFX_event_narrative_frame_religion
	title = EVTTITLE_MNM_1624
	desc = EVTDESC_MNM_1624 

	is_triggered_only = yes
	
	option = { # Ask it the secrets of Alchemy (stewardship)
		name = EVTOPTA_MNM_1624
		
		hidden_effect = {
			set_character_flag = divine_summoning_alchemy
			FROM = { character_event = { id = DWSOC.1625 } }
		}
	}

	option = { # Ask it the secrets of Astrology (diplomacy)
		name = EVTOPTB_MNM_1624
		
		hidden_effect = {
			set_character_flag = divine_summoning_astrology
			FROM = { character_event = { id = DWSOC.1625 } }
		}
	}

	option = { # Open your mind to the Divine (learning)
		name = EVTOPTC_MNM_1624
		
		hidden_effect = {
			set_character_flag = divine_summoning_open_mind
			FROM = { character_event = { id = DWSOC.1625 } }
		}
	}

	option = { # Ask it about how the Truth has been hidden (intrigue)
		name = EVTOPTD_MNM_1624
		
		hidden_effect = {
			set_character_flag = divine_summoning_hidden_truth
			FROM = { character_event = { id = DWSOC.1625 } }
		}
	}
}

# Bounce
character_event = {
	id = DWSOC.1625
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				FROM = {
					has_character_flag = divine_summoning_alchemy
					learning = 25
				}
			}
			random_list = {
				15 = {
					FROM = { set_character_flag = divine_summoning_success }
				}
				25 = {
					FROM = { set_character_flag = divine_summoning_alchemy_good_bonus }
				}
				40 = {
					FROM = { set_character_flag = divine_summoning_alchemy_bonus }
				}
				15 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_alchemy_penalty }
				}
				5 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_alchemy_bad_penalty }
				}
			}
		}
		if = {
			limit = {
				FROM = {
					has_character_flag = divine_summoning_alchemy
					learning = 20
					NOT = { learning = 25 }
				}
			}
			random_list = {
				10 = {
					FROM = { set_character_flag = divine_summoning_success }
				}
				20 = {
					FROM = { set_character_flag = divine_summoning_alchemy_good_bonus }
				}
				35 = {
					FROM = { set_character_flag = divine_summoning_alchemy_bonus }
				}
				20 = {
					FROM = { set_character_flag = divine_summoning_alchemy_penalty }
				}
				10 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_alchemy_bad_penalty }
				}
				5 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_failure }
				}
			}
		}
		if = {
			limit = {
				FROM = {
					has_character_flag = divine_summoning_alchemy
					learning = 15
					NOT = { learning = 20 }
				}
			}
			random_list = {
				5 = {
					FROM = { set_character_flag = divine_summoning_success }
				}
				10 = {
					FROM = { set_character_flag = divine_summoning_alchemy_good_bonus }
				}
				20 = {
					FROM = { set_character_flag = divine_summoning_alchemy_bonus }
				}
				35 = {
					FROM = { set_character_flag = divine_summoning_alchemy_penalty }
				}
				20 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_alchemy_bad_penalty }
				}
				10 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_failure }
				}
			}
		}
		if = {
			limit = {
				FROM = {
					has_character_flag = divine_summoning_alchemy
					NOT = { learning = 15 }
				}
			}
			random_list = {
				5 = {
					FROM = { set_character_flag = divine_summoning_alchemy_good_bonus }
				}
				15 = {
					FROM = { set_character_flag = divine_summoning_alchemy_bonus }
				}
				40 = {
					FROM = { set_character_flag = divine_summoning_alchemy_penalty }
				}
				25 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_alchemy_bad_penalty }
				}
				15 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_failure }
				}
			}
		}
		if = {
			limit = {
				FROM = {
					has_character_flag = divine_summoning_astrology
					learning = 25
				}
			}
			random_list = {
				15 = {
					FROM = { set_character_flag = divine_summoning_success }
				}
				25 = {
					FROM = { set_character_flag = divine_summoning_astrology_good_bonus }
				}
				40 = {
					FROM = { set_character_flag = divine_summoning_astrology_bonus }
				}
				15 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_astrology_penalty }
				}
				5 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_astrology_bad_penalty }
				}
			}
		}
		if = {
			limit = {
				FROM = {
					has_character_flag = divine_summoning_astrology
					learning = 20
					NOT = { learning = 25 }
				}
			}
			random_list = {
				10 = {
					FROM = { set_character_flag = divine_summoning_success }
				}
				20 = {
					FROM = { set_character_flag = divine_summoning_astrology_good_bonus }
				}
				35 = {
					FROM = { set_character_flag = divine_summoning_astrology_bonus }
				}
				20 = {
					FROM = { set_character_flag = divine_summoning_astrology_penalty }
				}
				10 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_astrology_bad_penalty }
				}
				5 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_failure }
				}
			}
		}
		if = {
			limit = {
				FROM = {
					has_character_flag = divine_summoning_astrology
					learning = 15
					NOT = { learning = 20 }
				}
			}
			random_list = {
				5 = {
					FROM = { set_character_flag = divine_summoning_success }
				}
				10 = {
					FROM = { set_character_flag = divine_summoning_astrology_good_bonus }
				}
				20 = {
					FROM = { set_character_flag = divine_summoning_astrology_bonus }
				}
				35 = {
					FROM = { set_character_flag = divine_summoning_astrology_penalty }
				}
				20 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_astrology_bad_penalty }
				}
				10 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_failure }
				}
			}
		}
		if = {
			limit = {
				FROM = {
					has_character_flag = divine_summoning_astrology
					NOT = { learning = 15 }
				}
			}
			random_list = {
				5 = {
					FROM = { set_character_flag = divine_summoning_astrology_good_bonus }
				}
				15 = {
					FROM = { set_character_flag = divine_summoning_astrology_bonus }
				}
				40 = {
					FROM = { set_character_flag = divine_summoning_astrology_penalty }
				}
				25 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_astrology_bad_penalty }
				}
				15 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_failure }
				}
			}
		}
		if = {
			limit = {
				FROM = {
					has_character_flag = divine_summoning_open_mind
					learning = 25
				}
			}
			random_list = {
				15 = {
					FROM = { set_character_flag = divine_summoning_success }
				}
				25 = {
					FROM = { set_character_flag = divine_summoning_open_mind_good_bonus }
				}
				40 = {
					FROM = { set_character_flag = divine_summoning_open_mind_bonus }
				}
				15 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_open_mind_penalty }
				}
				5 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_open_mind_bad_penalty }
				}
			}
		}
		if = {
			limit = {
				FROM = {
					has_character_flag = divine_summoning_open_mind
					learning = 20
					NOT = { learning = 25 }
				}
			}
			random_list = {
				10 = {
					FROM = { set_character_flag = divine_summoning_success }
				}
				20 = {
					FROM = { set_character_flag = divine_summoning_open_mind_good_bonus }
				}
				35 = {
					FROM = { set_character_flag = divine_summoning_open_mind_bonus }
				}
				20 = {
					FROM = { set_character_flag = divine_summoning_open_mind_penalty }
				}
				10 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_open_mind_bad_penalty }
				}
				5 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_failure }
				}
			}
		}
		if = {
			limit = {
				FROM = {
					has_character_flag = divine_summoning_open_mind
					learning = 15
					NOT = { learning = 20 }
				}
			}
			random_list = {
				5 = {
					FROM = { set_character_flag = divine_summoning_success }
				}
				10 = {
					FROM = { set_character_flag = divine_summoning_open_mind_good_bonus }
				}
				20 = {
					FROM = { set_character_flag = divine_summoning_open_mind_bonus }
				}
				40 = {
					FROM = { set_character_flag = divine_summoning_open_mind_penalty }
				}
				20 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_open_mind_bad_penalty }
				}
				10 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_failure }
				}
			}
		}
		if = {
			limit = {
				FROM = {
					has_character_flag = divine_summoning_open_mind
					NOT = { learning = 15 }
				}
			}
			random_list = {
				5 = {
					FROM = { set_character_flag = divine_summoning_open_mind_good_bonus }
				}
				15 = {
					FROM = { set_character_flag = divine_summoning_open_mind_bonus }
				}
				40 = {
					FROM = { set_character_flag = divine_summoning_open_mind_penalty }
				}
				25 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_open_mind_bad_penalty }
				}
				15 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_failure }
				}
			}
		}
		if = {
			limit = {
				FROM = {
					has_character_flag = divine_summoning_hidden_truth
					learning = 25
				}
			}
			random_list = {
				15 = {
					FROM = { set_character_flag = divine_summoning_success }
				}
				25 = {
					FROM = { set_character_flag = divine_summoning_hidden_truth_good_bonus }
				}
				40 = {
					FROM = { set_character_flag = divine_summoning_hidden_truth_bonus }
				}
				15 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_hidden_truth_penalty }
				}
				5 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_hidden_truth_bad_penalty }
				}
			}
		}
		if = {
			limit = {
				FROM = {
					has_character_flag = divine_summoning_hidden_truth
					learning = 20
					NOT = { learning = 25 }
				}
			}
			random_list = {
				10 = {
					FROM = { set_character_flag = divine_summoning_success }
				}
				20 = {
					FROM = { set_character_flag = divine_summoning_hidden_truth_good_bonus }
				}
				35 = {
					FROM = { set_character_flag = divine_summoning_hidden_truth_bonus }
				}
				20 = {
					FROM = { set_character_flag = divine_summoning_hidden_truth_penalty }
				}
				10 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_hidden_truth_bad_penalty }
				}
				5 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_failure }
				}
			}
		}
		if = {
			limit = {
				FROM = {
					has_character_flag = divine_summoning_hidden_truth
					learning = 15
					NOT = { learning = 20 }
				}
			}
			random_list = {
				5 = {
					FROM = { set_character_flag = divine_summoning_success }
				}
				10 = {
					FROM = { set_character_flag = divine_summoning_hidden_truth_good_bonus }
				}
				20 = {
					FROM = { set_character_flag = divine_summoning_hidden_truth_bonus }
				}
				35 = {
					FROM = { set_character_flag = divine_summoning_hidden_truth_penalty }
				}
				20 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_hidden_truth_bad_penalty }
				}
				10 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_failure }
				}
			}
		}
		if = {
			limit = {
				FROM = {
					has_character_flag = divine_summoning_hidden_truth
					NOT = { learning = 15 }
				}
			}
			random_list = {
				5 = {
					FROM = { set_character_flag = divine_summoning_hidden_truth_good_bonus }
				}
				15 = {
					FROM = { set_character_flag = divine_summoning_hidden_truth_bonus }
				}
				40 = {
					FROM = { set_character_flag = divine_summoning_hidden_truth_penalty }
				}
				25 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_hidden_truth_bad_penalty }
				}
				15 = {
					modifier = {
						factor = 0.5
						FROM = { has_character_flag = used_ingredients_for_summoning }
					}
					FROM = { set_character_flag = divine_summoning_failure }
				}
			}
		}
		FROM = { character_event = { id = DWSOC.1626 days = 15 random = 15  } }
		FROM = { clr_character_flag = used_ingredients_for_summoning }
	}
}

# Divine Summoning - Result
character_event = {
	id = DWSOC.1626
	picture = GFX_evt_shadowy_cabal
	border = GFX_event_normal_frame_religion
	
	desc = {
		text = EVTDESC_MNM_1626_SUCCESS
		trigger = {
			has_character_flag = divine_summoning_success
		}
	}
	desc = {
		text = EVTDESC_MNM_1626_FAILURE
		trigger = {
			has_character_flag = divine_summoning_failure
		}
	}
	desc = {
		text = EVTDESC_MNM_1626_ALCH_BONUS
		trigger = {
			OR = {
				has_character_flag = divine_summoning_alchemy_good_bonus
				has_character_flag = divine_summoning_alchemy_bonus
				has_character_flag = divine_summoning_alchemy_penalty
				has_character_flag = divine_summoning_alchemy_bad_penalty
			}
		}
	}
	desc = {
		text = EVTDESC_MNM_1626_ASTR_BONUS
		trigger = {
			OR = {
				has_character_flag = divine_summoning_astrology_good_bonus
				has_character_flag = divine_summoning_astrology_bonus
				has_character_flag = divine_summoning_astrology_penalty
				has_character_flag = divine_summoning_astrology_bad_penalty
			}
		}
	}
	desc = {
		text = EVTDESC_MNM_1626_MIND_BONUS
		trigger = {				
			OR = {
				has_character_flag = divine_summoning_open_mind_good_bonus
				has_character_flag = divine_summoning_open_mind_bonus
				has_character_flag = divine_summoning_open_mind_penalty
				has_character_flag = divine_summoning_open_mind_bad_penalty
			}
		}
	}
	desc = {
		text = EVTDESC_MNM_1626_TRUTH_BONUS
		trigger = {
			OR = {
				has_character_flag = divine_summoning_hidden_truth_good_bonus
				has_character_flag = divine_summoning_hidden_truth_bonus
				has_character_flag = divine_summoning_hidden_truth_penalty
				has_character_flag = divine_summoning_hidden_truth_bad_penalty
			}
		}
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTA_MNM_1626 # Success
		trigger = {
			NOT = {
				has_character_flag = divine_summoning_success
				has_character_flag = divine_summoning_failure
			}
		}
		if = {
			limit = {
				has_character_flag = divine_summoning_alchemy_good_bonus
			}
			add_character_modifier = {
				name = alchemy_good_ste_bonus
				years = 5
			}
		}
		if = {
			limit = {
				has_character_flag = divine_summoning_alchemy_bonus
			}
			add_character_modifier = {
				name = alchemy_ste_bonus
				years = 5
			}
		}
		if = {
			limit = {
				has_character_flag = divine_summoning_alchemy_penalty
			}
			add_character_modifier = {
				name = alchemy_ste_penalty
				years = 5
			}
		}
		if = {
			limit = {
				has_character_flag = divine_summoning_alchemy_bad_penalty
			}
			add_character_modifier = {
				name = alchemy_bad_ste_penalty
				years = 5
			}
		}
		if = {
			limit = {
				has_character_flag = divine_summoning_astrology_good_bonus
			}
			add_character_modifier = {
				name = astrology_good_dip_bonus
				years = 5
			}
		}
		if = {
			limit = {
				has_character_flag = divine_summoning_astrology_bonus
			}
			add_character_modifier = {
				name = astrology_dip_bonus
				years = 5
			}
		}
		if = {
			limit = {
				has_character_flag = divine_summoning_astrology_penalty
			}
			add_character_modifier = {
				name = astrology_dip_penalty
				years = 5
			}
		}
		if = {
			limit = {
				has_character_flag = divine_summoning_astrology_bad_penalty
			}
			add_character_modifier = {
				name = astrology_bad_dip_penalty
				years = 5
			}
		}
		if = {
			limit = {
				has_character_flag = divine_summoning_open_mind_good_bonus
			}
			add_character_modifier = {
				name = open_mind_good_lea_bonus
				years = 5
			}
		}
		if = {
			limit = {
				has_character_flag = divine_summoning_open_mind_bonus
			}
			add_character_modifier = {
				name = open_mind_lea_bonus
				years = 5
			}
		}
		if = {
			limit = {
				has_character_flag = divine_summoning_open_mind_penalty
			}
			add_character_modifier = {
				name = open_mind_lea_penalty
				years = 5
			}
		}
		if = {
			limit = {
				has_character_flag = divine_summoning_open_mind_bad_penalty
			}
			add_character_modifier = {
				name = open_mind_bad_lea_penalty
				years = 5
			}
		}
		if = {
			limit = {
				has_character_flag = divine_summoning_hidden_truth_good_bonus
			}
			add_character_modifier = {
				name = hidden_truth_good_int_bonus
				years = 5
			}
		}
		if = {
			limit = {
				has_character_flag = divine_summoning_hidden_truth_bonus
			}
			add_character_modifier = {
				name = hidden_truth_int_bonus
				years = 5
			}
		}
		if = {
			limit = {
				has_character_flag = divine_summoning_hidden_truth_penalty
			}
			add_character_modifier = {
				name = hidden_truth_int_penalty
				years = 5
			}
		}
		if = {
			limit = {
				has_character_flag = divine_summoning_hidden_truth_bad_penalty
			}
			add_character_modifier = {
				name = hidden_truth_bad_int_penalty
				years = 5
			}
		}
	}
	option = {
		name = EVTOPTB_MNM_1626 # Critical success
		trigger = {
			has_character_flag = divine_summoning_success
		}
		prestige = 100
		add_character_modifier = {
			name = divine_summoning_succeeded
			years = 10
		}
		add_society_currency_minor_effect = yes
	}
	option = {
		name = EVTOPTC_MNM_1626 # Failure
		trigger = {
			has_character_flag = divine_summoning_failure
		}
		prestige = -100
		add_character_modifier = {
			name = divine_summoning_failed
			years = 10
		}
	}
	after = {
		clr_character_flag = divine_summoning_success
		clr_character_flag = divine_summoning_failure
		clr_character_flag = divine_summoning_alchemy_good_bonus
		clr_character_flag = divine_summoning_alchemy_bonus
		clr_character_flag = divine_summoning_alchemy_penalty
		clr_character_flag = divine_summoning_alchemy_bad_penalty
		clr_character_flag = divine_summoning_astrology_good_bonus
		clr_character_flag = divine_summoning_astrology_bonus
		clr_character_flag = divine_summoning_astrology_penalty
		clr_character_flag = divine_summoning_astrology_bad_penalty
		clr_character_flag = divine_summoning_open_mind_good_bonus
		clr_character_flag = divine_summoning_open_mind_bonus
		clr_character_flag = divine_summoning_open_mind_penalty
		clr_character_flag = divine_summoning_open_mind_bad_penalty
		clr_character_flag = divine_summoning_hidden_truth_good_bonus
		clr_character_flag = divine_summoning_hidden_truth_bonus
		clr_character_flag = divine_summoning_hidden_truth_penalty
		clr_character_flag = divine_summoning_hidden_truth_bad_penalty
		clr_character_flag = divine_summoning_alchemy
		clr_character_flag = divine_summoning_astrology
		clr_character_flag = divine_summoning_open_mind
		clr_character_flag = divine_summoning_hidden_truth
	}
}

## Write a Theorem Paper

#Write a Theory Paper - choose approach
character_event = {
	id = DWSOC.1630
	desc = EVTDESC_MNM_1630
	picture = GFX_evt_scientist
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    option = { #Normal effort
    	name = EVTOPTA_MNM_1630
    	custom_tooltip = { text = EVTOPTA_MNM_1630_TT }
    	hidden_effect = {
    		set_character_flag = theory_paper_normal_effort
    		character_event = { id = DWSOC.1631 days = 90 random = 90 }
    	}
    }
    option = { #Get help from others
    	name = EVTOPTB_MNM_1630
    	trigger = {
    		diplomacy = 15
    	}
    	tooltip_info = diplomacy
    	custom_tooltip = { text = EVTOPTB_MNM_1630_TT }
    	hidden_effect = {
    		set_character_flag = theory_paper_asked_help
    		character_event = { id = DWSOC.1631 days = 90 random = 90 }
    	}
    }
    option = { #Steal another's work
    	name = EVTOPTC_MNM_1630
    	trigger = {
    		intrigue = 15
    	}
    	tooltip_info = intrigue
	   	custom_tooltip = { text = EVTOPTC_MNM_1630_TT }
    	hidden_effect = {
    		set_character_flag = theory_paper_stole_work
    		character_event = { id = DWSOC.1631 days = 90 random = 90 }
    	}
    }
    option = { #Invest heavily in research
    	name = EVTOPTD_MNM_1630
    	trigger = {
    		NOT = { trait = content }
    	}
    	if = {
    		limit = {
    			NOT = {
    				trait = ambitious
    				trait = content
    			}
    		}
    		random = {
    			chance = 10
    			add_trait = ambitious
    		}
    	}
    	if = {
    		limit = {
    			NOT = {
    				trait = stressed
    			}
    		}
    		random = {
    			chance = 10
    			add_trait = stressed
    		}
    	}
    	scaled_wealth = { value = -1 min = -25 }
    	piety = -50
    	add_character_modifier = {
    		name = theory_paper_heavy_investment
    		years = 1
    	}
    	custom_tooltip = { text = EVTOPTD_MNM_1630_TT }
    	hidden_effect = {
    		set_character_flag = theory_paper_heavy_investment
    		character_event = { id = DWSOC.1631 days = 180 random = 180 }
    	}
    }
}

#Ping event for deciding success
character_event = {
	id = DWSOC.1631
	hide_window = yes

	is_triggered_only = yes

	trigger = { is_alive = yes }

	immediate = {
		random_list = {
			15 = {
				modifier = {
					factor = 2
					learning = 25
				}
				modifier = {
					factor = 2
					has_character_flag = theory_paper_heavy_investment
				}
				modifier = {
					factor = 1.4
					has_character_flag = theory_paper_asked_help
				}
				modifier = {
					factor = 1.6
					has_character_flag = theory_paper_stole_work
				}
				modifier = {
					factor = 2
					trait = genius
				}
				modifier = {
					factor = 0.5
					trait = imbecile
				}
				modifier = {
					factor = 1.6
					trait = quick
				}
				modifier = {
					factor = 0.7
					trait = slow
				}
				modifier = {
					factor = 0.6
					trait = inbred
				}
				modifier = {
					factor = 1.4
					trait = shrewd
				}
				modifier = {
					factor = 0.8
					trait = dull
				}
				modifier = {
					factor = 1.3
					trait = mastermind_theologian
				}
				modifier = {
					factor = 1.4
					trait = scholar
				}
				modifier = {
					factor = 1.4
					trait = mystic
				}
				modifier = {
					factor = 1.4
					trait = theologian
				}
				modifier = {
					factor = 1.6
					trait = diligent
				}
				modifier = {
					factor = 0.7
					trait = slothful
				}
				modifier = {
					factor = 1.6
					trait = ambitious
				}
				modifier = {
					factor = 0.7
					trait = content
				}
				modifier = {
					factor = 1.6
					trait = erudite
				}
				set_character_flag = theory_paper_revolutionary
			}
			25 = {
				modifier = {
					factor = 2
					learning = 17
					NOT = { learning = 25 }
				}
				modifier = {
					factor = 2
					has_character_flag = theory_paper_heavy_investment
				}
				modifier = {
					factor = 1.3
					has_character_flag = theory_paper_asked_help
				}
				modifier = {
					factor = 1.6
					has_character_flag = theory_paper_stole_work
				}
				modifier = {
					factor = 2
					trait = genius
				}
				modifier = {
					factor = 0.5
					trait = imbecile
				}
				modifier = {
					factor = 1.6
					trait = quick
				}
				modifier = {
					factor = 0.7
					trait = slow
				}
				modifier = {
					factor = 0.6
					trait = inbred
				}
				modifier = {
					factor = 1.4
					trait = shrewd
				}
				modifier = {
					factor = 0.8
					trait = dull
				}
				modifier = {
					factor = 1.3
					trait = scholarly_theologian
				}
				modifier = {
					factor = 1.4
					trait = scholar
				}
				modifier = {
					factor = 1.4
					trait = mystic
				}
				modifier = {
					factor = 1.4
					trait = theologian
				}
				modifier = {
					factor = 1.6
					trait = diligent
				}
				modifier = {
					factor = 0.7
					trait = slothful
				}
				modifier = {
					factor = 1.6
					trait = ambitious
				}
				modifier = {
					factor = 0.7
					trait = content
				}
				modifier = {
					factor = 1.6
					trait = erudite
				}
				set_character_flag = theory_paper_excellent
			}
			35 = {
				modifier = {
					factor = 2
					learning = 9
					NOT = { learning = 17 }
				}
				modifier = {
					factor = 1.3
					trait = martial_cleric
				}
				set_character_flag = theory_paper_average
			}
			25 = {
				modifier = {
					factor = 2
					NOT = { learning = 9 }
				}
				modifier = {
					factor = 0.5
					has_character_flag = theory_paper_heavy_investment
				}
				modifier = {
					factor = 0.8
					has_character_flag = theory_paper_asked_help
				}
				modifier = {
					factor = 0.7
					has_character_flag = theory_paper_stole_work
				}
				modifier = {
					factor = 0.5
					trait = genius
				}
				modifier = {
					factor = 2
					trait = imbecile
				}
				modifier = {
					factor = 2
					trait = lunatic
				}
				modifier = {
					factor = 0.7
					trait = quick
				}
				modifier = {
					factor = 1.6
					trait = slow
				}
				modifier = {
					factor = 1.8
					trait = inbred
				}
				modifier = {
					factor = 0.8
					trait = shrewd
				}
				modifier = {
					factor = 1.4
					trait = dull
				}
				modifier = {
					factor = 1.3
					trait = detached_priest
				}
				modifier = {
					factor = 0.8
					trait = scholar
				}
				modifier = {
					factor = 0.8
					trait = mystic
				}
				modifier = {
					factor = 0.8
					trait = theologian
				}
				modifier = {
					factor = 0.7
					trait = diligent
				}
				modifier = {
					factor = 1.6
					trait = slothful
				}
				modifier = {
					factor = 0.7
					trait = ambitious
				}
				modifier = {
					factor = 1.6
					trait = content
				}
				modifier = {
					factor = 0.7
					trait = erudite
				}
				set_character_flag = theory_paper_simplistic
			}
		}
		remove_character_modifier = theory_paper_heavy_investment
		character_event = { id = DWSOC.1640 }
	}
}

#Write a Theory Paper - Finished Paper
character_event = {
	id = DWSOC.1640
	desc = {
		text = EVTDESCA_MNM_1640_RITUALS
		trigger = {
			has_character_flag = MNM_1640_rituals
		}
	}
	desc = {
		text = EVTDESCA_MNM_1640_ASCENSION
		trigger = {
			has_character_flag = MNM_1640_ascension
		}
	}
	desc = {
		text = EVTDESCA_MNM_1640_MIND_OF_GOD
		trigger = {
			has_character_flag = MNM_1640_mind_of_god
		}
	}
	desc = {
		text = EVTDESCA_MNM_1640_TRANSLATING_HIEROGLYPHICS
		trigger = {
			has_character_flag = MNM_1640_translating_hieroglyphics
		}
	}
	desc = {
		text = EVTDESCA_MNM_1640_DISTILLATION
		trigger = {
			has_character_flag = MNM_1640_distillation
		}
	}
	desc = {
		text = EVTDESCA_MNM_1640_FERMENTATION
		trigger = {
			has_character_flag = MNM_1640_fermentation
		}
	}
	desc = {
		text = EVTDESCA_MNM_1640_ELIXIR_OF_LIFE
		trigger = {
			has_character_flag = MNM_1640_elixir_of_life
		}
	}
	desc = {
		text = EVTDESCA_MNM_1640_PILOSOPHERS_STONE
		trigger = {
			has_character_flag = MNM_1640_philosophers_stone
		}
	}
	desc = {
		text = EVTDESCA_MNM_1640_PLANETS
		trigger = {
			has_character_flag = MNM_1640_planets
		}
	}
	desc = {
		text = EVTDESCA_MNM_1640_STARS
		trigger = {
			has_character_flag = MNM_1640_stars
		}
	}
	desc = {
		text = EVTDESCA_MNM_1640_MOON
		trigger = {
			has_character_flag = MNM_1640_moon
		}
	}
	desc = {
		text = EVTDESCA_MNM_1640_SUN
		trigger = {
			has_character_flag = MNM_1640_sun
		}
	}
	picture = GFX_evt_scientist
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			10 = {
				set_character_flag = MNM_1640_rituals
				modifier = {
					factor = 3
					trait = theologian
				}
			}
			10 = {
				set_character_flag = MNM_1640_ascension
				modifier = {
					factor = 3
					trait = theologian
				}
			}
			10 = {
				set_character_flag = MNM_1640_mind_of_god
				modifier = {
					factor = 3
					trait = theologian
				}
			}
			10 = {
				set_character_flag = MNM_1640_translating_hieroglyphics
				modifier = {
					factor = 3
					trait = scholar
				}
				modifier = {
					factor = 2
					trait = erudite
				}
			}
			10 = {
				set_character_flag = MNM_1640_distillation
				modifier = {
					factor = 3
					trait = mystic
				}
				modifier = {
					factor = 2
					trait = erudite
				}
			}
			10 = {
				set_character_flag = MNM_1640_fermentation
				modifier = {
					factor = 3
					trait = mystic
				}
				modifier = {
					factor = 2
					trait = erudite
				}
			}
			10 = {
				set_character_flag = MNM_1640_elixir_of_life
				modifier = {
					factor = 3
					trait = mystic
				}
			}
			10 = {
				set_character_flag = MNM_1640_philosophers_stone
				modifier = {
					factor = 3
					trait = mystic
				}
			}
			10 = {
				set_character_flag = MNM_1640_planets
				modifier = {
					factor = 3
					trait = scholar
				}
				modifier = {
					factor = 3
					trait = diligent
				}
			}
			10 = {
				set_character_flag = MNM_1640_stars
				modifier = {
					factor = 3
					trait = scholar
				}
			}
			10 = {
				set_character_flag = MNM_1640_moon
				modifier = {
					factor = 3
					trait = scholar
				}
			}
			10 = {
				set_character_flag = MNM_1640_sun
				modifier = {
					factor = 3
					trait = scholar
				}
			}
		}
		set_variable = {
			which = peer_review
			value = 0
		}
		
		society = {
			random_society_member = {
				limit = {
					NOT = { character = ROOT }
					is_within_diplo_range = ROOT
					NOT = { is_inaccessible_trigger = yes }
				}
				save_event_target_as = peer1
				set_character_flag = peer_review_temp
			}
			random_society_member = {
				limit = {
					NOT = { character = ROOT }
					is_within_diplo_range = ROOT
					NOT = { is_inaccessible_trigger = yes }
					NOT = { has_character_flag = peer_review_temp }
				}
				save_event_target_as = peer2
				set_character_flag = peer_review_temp
			}
			random_society_member = {
				limit = {
					NOT = { character = ROOT }
					is_within_diplo_range = ROOT
					NOT = { is_inaccessible_trigger = yes }
					NOT = { has_character_flag = peer_review_temp }
				}
				save_event_target_as = peer3
				set_character_flag = peer_review_temp
			}
			random_society_member = {
				limit = {
					NOT = { character = ROOT }
					is_within_diplo_range = ROOT
					NOT = { is_inaccessible_trigger = yes }
					NOT = { has_character_flag = peer_review_temp }
				}
				save_event_target_as = peer4
				set_character_flag = peer_review_temp
			}
			random_society_member = {
				limit = {
					NOT = { character = ROOT }
					is_within_diplo_range = ROOT
					NOT = { is_inaccessible_trigger = yes }
					NOT = { has_character_flag = peer_review_temp }
				}
				save_event_target_as = peer5
				set_character_flag = peer_review_temp
			}
			event_target:peer1 = { clr_character_flag = peer_review_temp }
			event_target:peer2 = { clr_character_flag = peer_review_temp }
			event_target:peer3 = { clr_character_flag = peer_review_temp }
			event_target:peer4 = { clr_character_flag = peer_review_temp }
			event_target:peer5 = { clr_character_flag = peer_review_temp }
		}
	}
	
	option = { #send it out for review!
		name = EVTOPTA_MNM_1640
		
		event_target:peer1 = { 
			character_event = { id = DWSOC.1641 days = 15 } 
			set_character_flag = show_tooltip
			clr_character_flag = show_tooltip
		}
		event_target:peer2 = { 
			character_event = { id = DWSOC.1641 days = 18 } 
			set_character_flag = show_tooltip
			clr_character_flag = show_tooltip
		}
		event_target:peer3 = { 
			character_event = { id = DWSOC.1641 days = 21 } 
			set_character_flag = show_tooltip
			clr_character_flag = show_tooltip
		}
		event_target:peer4 = { 
			character_event = { id = DWSOC.1641 days = 24 } 
			set_character_flag = show_tooltip
			clr_character_flag = show_tooltip
		}
		event_target:peer5 = { 
			character_event = { id = DWSOC.1641 days = 27 } 
			set_character_flag = show_tooltip
			clr_character_flag = show_tooltip
		}
		
		custom_tooltip = {
			text = EVTTOOLTIPA_MNM_1640
			hidden_effect = {
				set_variable = {
					which = peer_review_score
					value = 0
				}
				character_event = { id = DWSOC.1644 days = 100 }
			}
		}
	}
	
	option = { #No, this shall never see the light of day!
		name = EVTOPTB_MNM_1640

		custom_tooltip = {
			text = EVTTOOLTIPB_MNM_1640
			hidden_effect = {
				clr_character_flag = theory_paper_normal_effort
				clr_character_flag = theory_paper_asked_help
				clr_character_flag = theory_paper_stole_work
				clr_character_flag = theory_paper_heavy_investment
				clr_character_flag = theory_paper_revolutionary
				clr_character_flag = theory_paper_excellent
				clr_character_flag = theory_paper_average
				clr_character_flag = theory_paper_simplistic
			}
		}
	}
	
	after = {
		clr_character_flag = MNM_1640_rituals
		clr_character_flag = MNM_1640_ascension
		clr_character_flag = MNM_1640_mind_of_god
		clr_character_flag = MNM_1640_translating_hieroglyphics
		clr_character_flag = MNM_1640_distillation
		clr_character_flag = MNM_1640_fermentation
		clr_character_flag = MNM_1640_elixir_of_life
		clr_character_flag = MNM_1640_philosophers_stone
		clr_character_flag = MNM_1640_planets
		clr_character_flag = MNM_1640_stars
		clr_character_flag = MNM_1640_moon
		clr_character_flag = MNM_1640_sun
	}
}

#Theory Paper - Peer Reviewer's event
character_event = {
	id = DWSOC.1641
	desc = {
		text = EVTDESCA_MNM_1641_RITUALS
		trigger = {
			FROM = { has_character_flag = MNM_1640_rituals }
		}
	}
	desc = {
		text = EVTDESCA_MNM_1641_ASCENSION
		trigger = {
			FROM = { has_character_flag = MNM_1640_ascension }
		}
	}
	desc = {
		text = EVTDESCA_MNM_1641_MIND_OF_GOD
		trigger = {
			FROM = { has_character_flag = MNM_1640_mind_of_god }
		}
	}
	desc = {
		text = EVTDESCA_MNM_1641_TRANSLATING_HIEROGLYPHICS
		trigger = {
			FROM = { has_character_flag = MNM_1640_translating_hieroglyphics }
		}
	}
	desc = {
		text = EVTDESCA_MNM_1641_DISTILLATION
		trigger = {
			FROM = { has_character_flag = MNM_1640_distillation }
		}
	}
	desc = {
		text = EVTDESCA_MNM_1641_FERMENTATION
		trigger = {
			FROM = { has_character_flag = MNM_1640_fermentation }
		}
	}
	desc = {
		text = EVTDESCA_MNM_1641_ELIXIR_OF_LIFE
		trigger = {
			FROM = { has_character_flag = MNM_1640_elixir_of_life }
		}
	}
	desc = {
		text = EVTDESCA_MNM_1641_PILOSOPHERS_STONE
		trigger = {
			FROM = { has_character_flag = MNM_1640_philosophers_stone }
		}
	}
	desc = {
		text = EVTDESCA_MNM_1641_PLANETS
		trigger = {
			FROM = { has_character_flag = MNM_1640_planets }
		}
	}
	desc = {
		text = EVTDESCA_MNM_1641_STARS
		trigger = {
			FROM = { has_character_flag = MNM_1640_stars }
		}
	}
	desc = {
		text = EVTDESCA_MNM_1641_MOON
		trigger = {
			FROM = { has_character_flag = MNM_1640_moon }
		}
	}
	desc = {
		text = EVTDESCA_MNM_1641_SUN
		trigger = {
			FROM = { has_character_flag = MNM_1640_sun }
		}
	}
	picture = GFX_evt_gathering_of_minds
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				FROM = { has_character_flag = theory_paper_stole_work }
			}
			random_list = {
				10 = { # Discovered knowledge theft
					modifier = {
						factor = 1.3
						intrigue = 2
						learning = 2
					}
					modifier = {
						factor = 1.3
						intrigue = 4
						learning = 4
					}
					modifier = {
						factor = 1.3
						intrigue = 6
						learning = 6
					}
					modifier = {
						factor = 1.3
						intrigue = 8
						learning = 8
					}
					modifier = {
						factor = 1.3
						intrigue = 10
						learning = 10
					}
					modifier = {
						factor = 1.3
						intrigue = 12
						learning = 12
					}
					modifier = {
						factor = 1.3
						intrigue = 14
						learning = 14
					}
					modifier = {
						factor = 1.3
						intrigue = 16
						learning = 16
					}
					modifier = {
						factor = 1.3
						intrigue = 18
						learning = 18
					}
					modifier = {
						factor = 1.3
						intrigue = 20
						learning = 20
					}
					
					set_character_flag = discovered_knowledge_theft
				}
				1000 = { #no discovery
					
				}
			}
		}
	}
	
	option = { # Endorse
		name = EVTOPTA_MNM_1641
		trigger = {
			NOT = { has_character_flag = discovered_knowledge_theft }
		}
		ai_chance = {
			factor = 70
			
			modifier = {
				factor = 1.3
				opinion = {
					who = ROOT
					value = 20
				}
			}
			modifier = {
				factor = 1.3
				opinion = {
					who = ROOT
					value = 40
				}
			}
			modifier = {
				factor = 1.3
				opinion = {
					who = ROOT
					value = 60
				}
			}
			modifier = {
				factor = 1.3
				opinion = {
					who = ROOT
					value = 80
				}
			}
			modifier = {
				factor = 0.5
				NOT = {
					opinion = {
						who = ROOT
						value = 1
					}
				}
			}
			modifier = {
				factor = 0.5
				NOT = {
					opinion = {
						who = ROOT
						value = -19
					}
				}
			}
			modifier = {
				factor = 0.5
				NOT = {
					opinion = {
						who = ROOT
						value = -39
					}
				}
			}
			
			modifier = {
				factor = 1.2
				FROM = {
					OR = {
						has_character_flag = theory_paper_average
						has_character_flag = theory_paper_excellent
						has_character_flag = theory_paper_revolutionary
					}
				}
				learning = 7
			}
			modifier = {
				factor = 1.2
				FROM = {
					OR = {
						has_character_flag = theory_paper_excellent
						has_character_flag = theory_paper_revolutionary
					}
				}
				learning = 10
			}
			modifier = {
				factor = 1.2
				FROM = {
					has_character_flag = theory_paper_revolutionary
				}
				learning = 13
			}
			modifier = {
				factor = 0.6
				FROM = {
					has_character_flag = theory_paper_simplistic
				}
				learning = 7
			}
			modifier = {
				factor = 2
				FROM = {
					has_character_flag = theory_paper_simplistic
				}
				NOT = { learning = 7 }
			}
		}
		
		custom_tooltip = {
			text = EVTTOOLTIPA_MNM_1641
			hidden_effect = {
				FROM = {
					change_variable = {
						which = peer_review_score
						value = 1
					}
					letter_event = { id = DWSOC.1642 }
				}
			}
		}
	}
	
	option = { # Refute
		name = EVTOPTB_MNM_1641
		trigger = {
			NOT = { has_character_flag = discovered_knowledge_theft }
		}
		ai_chance = {
			factor = 30
		}
		
		custom_tooltip = {
			text = EVTTOOLTIPB_MNM_1641
			hidden_effect = {
				set_character_flag = refuted_paper_@FROM
				FROM = {
					letter_event = { id = DWSOC.1643 }
				}
			}
		}
		
		tooltip = {
			opinion = {
				who = FROM
				modifier = opinion_academic_failure
				years = 15
			}
			reverse_opinion = {
				who = FROM
				modifier = opinion_academic_grudge
				years = 15
			}
		}
	}
	
	option = { # Discovered plagiarism
		name = EVTOPTC_MNM_1641
		trigger = {
			has_character_flag = discovered_knowledge_theft
		}
		add_society_currency_minor_effect = yes
		prestige = 125
		custom_tooltip = {
			text = EVTTOOLTIPC_MNM_1641
			hidden_effect = {
				FROM = {
					character_event = { id = DWSOC.1646 }
				}
			}
		}
	}
}

# Peer endorsed paper
letter_event = {
	id = DWSOC.1642
	desc = EVTDESC_MNM_1642
	border = GFX_event_letter_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EXCELLENT
		opinion = {
			who = FROM
			modifier = opinion_grateful_invitation
			years = 10
		}
	}
}

# Peer refuted paper
letter_event = {
	id = DWSOC.1643
	desc = EVTDESC_MNM_1643
	border = GFX_event_letter_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_1643
		opinion = {
			who = FROM
			modifier = opinion_academic_grudge
			years = 15
		}
		reverse_opinion = {
			who = FROM
			modifier = opinion_academic_grudge
			years = 15
		}
	}
}

# Results
character_event = {
	id = DWSOC.1644
	desc = {
		text = EVTDESCA_MNM_1644
		trigger = {
			has_character_flag = paper_success
		}
	}
	desc = {
		text = EVTDESCB_MNM_1644
		trigger = {
			has_character_flag = paper_failure
		}
	}
	picture = GFX_evt_gathering_of_minds
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		#Calc success/failure
		if = {
			limit = {
				check_variable = {
					which = peer_review_score
					value = 3
				}
			}
			set_character_flag = paper_success
			break = yes
		}
		set_character_flag = paper_failure
	}
	
	option = {
		name = EVTOPTA_MNM_1644
		trigger = {
			has_character_flag =  paper_success
		}
		
		prestige = 75
		add_character_modifier = {
			modifier = published_theorem
			years = 5
		}
		add_society_currency_minor_effect = yes
		hidden_effect = {
			event_target:peer1 = { set_character_flag = paper_success character_event = { id = DWSOC.1645 } }
			event_target:peer2 = { set_character_flag = paper_success character_event = { id = DWSOC.1645 } }
			event_target:peer3 = { set_character_flag = paper_success character_event = { id = DWSOC.1645 } }
			event_target:peer4 = { set_character_flag = paper_success character_event = { id = DWSOC.1645 } }
			event_target:peer5 = { set_character_flag = paper_success character_event = { id = DWSOC.1645 } }
		}
	}
	
	option = {
		name = EVTOPTB_MNM_1644
		trigger = {
			has_character_flag =  paper_failure
		}
		
		prestige = -75
		detract_society_currency_minor_effect = yes
		hidden_effect = {
			event_target:peer1 = { set_character_flag = paper_failure character_event = { id = DWSOC.1645 } }
			event_target:peer2 = { set_character_flag = paper_failure character_event = { id = DWSOC.1645 } }
			event_target:peer3 = { set_character_flag = paper_failure character_event = { id = DWSOC.1645 } }
			event_target:peer4 = { set_character_flag = paper_failure character_event = { id = DWSOC.1645 } }
			event_target:peer5 = { set_character_flag = paper_failure character_event = { id = DWSOC.1645 } }
		}
	}
	after = {
		clr_character_flag = paper_success
		clr_character_flag = paper_failure
		clr_character_flag = discovered_knowledge_theft
		clr_character_flag = theory_paper_normal_effort
		clr_character_flag = theory_paper_asked_help
		clr_character_flag = theory_paper_stole_work
		clr_character_flag = theory_paper_heavy_investment
		clr_character_flag = theory_paper_revolutionary
		clr_character_flag = theory_paper_excellent
		clr_character_flag = theory_paper_average
		clr_character_flag = theory_paper_simplistic
		clr_character_flag = refuted_paper_@ROOT
	}
}

#Notice event for peers who endorsed the paper
character_event = {
	id = DWSOC.1645
	desc = {
		text = EVTDESCA_MNM_1645
		trigger = {
			FROM = { has_character_flag = paper_success }
		}
	}
	desc = {
		text = EVTDESCB_MNM_1645
		trigger = {
			FROM = { has_character_flag = paper_failure }
		}
	}
	picture = GFX_evt_gathering_of_minds
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	trigger = {
		NOT = { has_character_flag = refuted_paper_@FROM }
	}
	
	option = {
		name = EVTOPTA_MNM_1645
		trigger = {
			FROM = { has_character_flag = paper_success }
		}
		add_character_modifier = {
			modifier = endorsed_theorem
			years = 5
		}
	}
	
	option = {
		name = EVTOPTB_MNM_1645
		trigger = {
			FROM = { has_character_flag = paper_failure }
		}
	}
}

# Discovered stealing knowledge
character_event = {
	id = DWSOC.1646
	desc = EVTDESC_MNM_1646
	picture = GFX_evt_scandal
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		clear_delayed_event = { id = DWSOC.1644 }
	}
	
	option = {
		name = CURSES
		
		prestige = -75
		detract_society_currency_minor_effect = yes
		society = {
			any_society_member = {
				limit = {
					NOT = { character = ROOT }
				}
				opinion = {
					who = ROOT
					modifier = opinion_knowledge_theft
					years = 20
				}
			}
		}
	}
}


#Misc: apprenticeship
#Ping event for apprenticeship completion
character_event = {
    id = DWSOC.1413
    hide_window = yes
    is_triggered_only = yes
    trigger = { 
    	liege = {
    		character = FROMFROM
    		is_alive = yes
    		society_member_of = dw_the_wizards
    	}
    	has_minor_title = title_dw_the_wizards_apprentice

    }
    immediate = { FROMFROM = { character_event = { id = DWSOC.1414 } } }
}

#Apprenticeship completion
character_event = {
    id = DWSOC.1414
    desc = EVTDESC_MNM_1414
    picture = GFX_evt_gathering_of_minds
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
    
    option = { 
		name = EVTOPTA_MNM_1414

        add_society_currency_major_effect = yes

        FROM = { 
        	set_character_flag = completed_apprenticeship 
        	remove_title = title_dw_the_wizards_apprentice
        	change_learning = 2
        }
    }
}

#Apprentice died
character_event = {
    id = DWSOC.1415
    hide_window = yes
    is_triggered_only = yes

    is_in_society = yes
    ai = yes

    trigger = {
    	society_member_of = dw_the_wizards
    	has_minor_title = title_dw_the_wizards_apprentice
    }

    immediate = {
    	liege = { character_event = { id = DWSOC.1416 } }
    }
}

#Notification of dead apprentice
character_event = {
    id = DWSOC.1416
    picture = GFX_evt_death
    border = GFX_event_normal_frame_religion

    desc = {
    	trigger = {
    		NOR = {
    			NOT = { opinion = { value = 0 who = FROM } }
    			NOT = { FROM = { learning = 12 } }
    		}
    	}
    	text = EVTDESC_MNM_1416_A
    }
    desc = {
    	trigger = {
    		OR = {
    			NOT = { opinion = { value = 0 who = FROM } }
    			NOT = { FROM = { learning = 12 } }
    		}
    	}
    	text = EVTDESC_MNM_1416_B
    }

    is_triggered_only = yes
    
    option = { 
        name = EVTOPTA_MNM_1416
    }
}

### Archmagi Power: Write an Arcane Theory tome###
#Write an Arcane Theory tome - Start Writing
narrative_event = {
	id = DWSOC.1610
	picture = a_placeholder
	title = dw_arcane_theory_title
	desc = { # female
		trigger = {
			is_female = yes
		}
		text = DWSOC1610
		picture = wizard_book_female1
	}
	desc = { # male
		trigger = {
			NOT = { is_female = yes }
		}
		text = DWSOC1610
		picture = wizard_book_male1
	}
    is_triggered_only = yes # triggered by decision
    option = { # It shall be one of my finest works
    	name = DWSOC1610A
    	add_character_modifier = {
    		modifier = dw_writing_arcane_theory
			years = 2
    	}
    	hidden_effect = {
    		character_event = { id = DWSOC.1600 days = 90 random = 60 }
    	}
    }
}

#Write a Magnum Opus - Pick Pillar
character_event = {
	id = DWSOC.1600
	desc = EVTDESC_MNM_1600
	picture = GFX_evt_scientist
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    trigger = {	society_member_of = dw_the_wizards }

    option = { #write book on Theurgy
    	name = EVTOPTA_MNM_1600
    	trigger = {
    		NOT = {
    			AND = {
    				OR = {
    					has_artifact = arcane_theory_ritual_magic_1
						has_artifact = arcane_theory_ritual_magic_2
						has_artifact = arcane_theory_ritual_magic_3
						has_artifact = arcane_theory_ritual_magic_4
    				}
    				OR = {
    					has_artifact = arcane_theory_formula_magic_1
						has_artifact = arcane_theory_formula_magic_2
						has_artifact = arcane_theory_formula_magic_3
						has_artifact = arcane_theory_formula_magic_4
    				}
    			}
    		}
    	}
    	custom_tooltip = { text = EVTOPTA_MNM_1600_TT }
    	hidden_effect = {
    		character_event = { id = DWSOC.1601 days = 90 random = 60 }
    	}
    }

    option = { #write book on Astrology
    	name = EVTOPTB_MNM_1600
    	trigger = {
    		NOT = {
    			AND = {
    				OR = {
    					has_artifact = arcane_theory_magic_techniques_1
						has_artifact = arcane_theory_magic_techniques_2
						has_artifact = arcane_theory_magic_techniques_3
						has_artifact = arcane_theory_magic_techniques_4
    				}
    				OR = {
    					has_artifact = arcane_theory_magic_forms_1
						has_artifact = arcane_theory_magic_forms_2
						has_artifact = arcane_theory_magic_forms_3
						has_artifact = arcane_theory_magic_forms_4
    				}
    			}
    		}
    	}
    	custom_tooltip = { text = EVTOPTB_MNM_1600_TT }
    	hidden_effect = {
    		character_event = { id = DWSOC.1602 days = 90 random = 60 }
    	}
    }

    option = { #write book on Alchemy
    	name = EVTOPTC_MNM_1600
    	trigger = {
    		NOT = {
    			AND = {
    				OR = {
    					has_artifact = arcane_theory_arcane_bestiary_1
						has_artifact = arcane_theory_arcane_bestiary_2
						has_artifact = arcane_theory_arcane_bestiary_3
						has_artifact = arcane_theory_arcane_bestiary_4
    				}
    				OR = {
    					has_artifact = arcane_theory_realms_power_1
						has_artifact = arcane_theory_realms_power_2
						has_artifact = arcane_theory_realms_power_3
						has_artifact = arcane_theory_realms_power_4
    				}
    			}
    		}
    	}
    	custom_tooltip = { text = EVTOPTC_MNM_1600_TT }
    	hidden_effect = {
    		character_event = { id = DWSOC.1603 days = 90 random = 60 }
    	}
    }
}

#Write a Magnum Opus - Pick type of Theurgy
character_event = {
	id = DWSOC.1601
	desc = EVTDESC_MNM_1601
	picture = GFX_evt_secluded_in_prayer
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	trigger = {	society_member_of = dw_the_wizards }

	option = { #Focus on Rituals/Invocation
		name = EVTOPTA_MNM_1601
		trigger = {
			NOT = {
				OR = {
    				has_artifact = arcane_theory_ritual_magic_1
					has_artifact = arcane_theory_ritual_magic_2
					has_artifact = arcane_theory_ritual_magic_3
					has_artifact = arcane_theory_ritual_magic_4
    			}
			}
		}
		custom_tooltip = { text = EVTOPTA_MNM_1601_TT }
    	hidden_effect = {
    		character_event = { id = DWSOC.1604 days = 90 random = 60 }
    	}
	}

	option = { #Focus on Contemplation
    	name = EVTOPTB_MNM_1601
    	trigger = {
			NOT = {
				OR = {
    				has_artifact = arcane_theory_formula_magic_1
					has_artifact = arcane_theory_formula_magic_2
					has_artifact = arcane_theory_formula_magic_3
					has_artifact = arcane_theory_formula_magic_4
    			}
			}
		}
    	custom_tooltip = { text = EVTOPTB_MNM_1601_TT }
    	hidden_effect = {
    		character_event = { id = DWSOC.1605 days = 90 random = 60 }
    	}
    }
}

#Write a Magnum Opus - Pick type of Astrology
character_event = {
	id = DWSOC.1602
	desc = EVTDESC_MNM_1602
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
    
    trigger = {	society_member_of = dw_the_wizards }

	option = { #Focus on Stars
		name = EVTOPTA_MNM_1602
		trigger = {
			NOT = {
				OR = {
    				has_artifact = arcane_theory_magic_techniques_1
					has_artifact = arcane_theory_magic_techniques_2
					has_artifact = arcane_theory_magic_techniques_3
					has_artifact = arcane_theory_magic_techniques_4
    			}
			}
		}
		custom_tooltip = { text = EVTOPTA_MNM_1602_TT }
    	hidden_effect = {
    		character_event = { id = DWSOC.1606 days = 90 random = 60 }
    	}
	}

	option = { #Focus on Planets
    	name = EVTOPTB_MNM_1602
    	trigger = {
			NOT = {
				OR = {
    				has_artifact = arcane_theory_magic_forms_1
					has_artifact = arcane_theory_magic_forms_2
					has_artifact = arcane_theory_magic_forms_3
					has_artifact = arcane_theory_magic_forms_4
    			}
			}
		}
    	custom_tooltip = { text = EVTOPTB_MNM_1602_TT }
    	hidden_effect = {
    		character_event = { id = DWSOC.1607 days = 90 random = 60 }
    	}
    }
}

#Write a Magnum Opus - Pick type of Alchemy
character_event = {
	id = DWSOC.1603
	desc = EVTDESC_MNM_1603
	picture = GFX_evt_experiment
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

    trigger = {	society_member_of = dw_the_wizards }

	option = { #Focus on Universal Panacea
		name = EVTOPTA_MNM_1603
		trigger = {
			NOT = {
				OR = {
    				has_artifact = arcane_theory_arcane_bestiary_1
					has_artifact = arcane_theory_arcane_bestiary_2
					has_artifact = arcane_theory_arcane_bestiary_3
					has_artifact = arcane_theory_arcane_bestiary_4
    			}
			}
		}
		custom_tooltip = { text = EVTOPTA_MNM_1603_TT }
    	hidden_effect = {
    		character_event = { id = DWSOC.1608 days = 90 random = 60 }
    	}
	}

	option = { #Focus on Transmutation
    	name = EVTOPTB_MNM_1603
    	trigger = {
			NOT = {
				OR = {
    				has_artifact = arcane_theory_realms_power_1
					has_artifact = arcane_theory_realms_power_2
					has_artifact = arcane_theory_realms_power_3
					has_artifact = arcane_theory_realms_power_4
    			}
			}
		}
    	custom_tooltip = { text = EVTOPTB_MNM_1603_TT }
    	hidden_effect = {
    		character_event = { id = DWSOC.1609 days = 90 random = 60 }
    	}
    }
}

#Write a Magnum Opus - Finish book on Ritualistic/Invocative Theurgy
character_event = {
	id = DWSOC.1604
	desc = EVTDESC_MNM_1604
	picture = GFX_evt_secluded_in_prayer
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = { #Awesome!
		name = EVTOPTA_MNM_1604
		if = {
			limit = {
				NOT = { learning = 12 }
			}
			prestige = 50
    		add_artifact = arcane_theory_ritual_magic_1
		}
		if = {
			limit = {
				learning = 12
				NOT = { learning = 18 }
			}
			prestige = 100
    		add_artifact = arcane_theory_ritual_magic_2
		}
		if = {
			limit = {
				learning = 18
				NOT = { learning = 25 }
			}
			prestige = 150
    		add_artifact = arcane_theory_ritual_magic_3
		}
		if = {
			limit = {
				learning = 25
			}
			prestige = 200
    		add_artifact = arcane_theory_ritual_magic_4
		}
		remove_character_modifier = dw_writing_arcane_theory
	}
}

#Write a Magnum Opus - Finish book on Contemplative Theurgy
character_event = {
	id = DWSOC.1605
	desc = EVTDESC_MNM_1605
	picture = GFX_evt_secluded_in_prayer
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = { #Awesome!
		name = EVTOPTA_MNM_1605
		if = {
			limit = {
				NOT = { learning = 12 }
			}
			prestige = 50
    		add_artifact = arcane_theory_formula_magic_1
		}
		if = {
			limit = {
				learning = 12
				NOT = { learning = 18 }
			}
			prestige = 100
    		add_artifact = arcane_theory_formula_magic_2
		}
		if = {
			limit = {
				learning = 18
				NOT = { learning = 25 }
			}
			prestige = 150
    		add_artifact = arcane_theory_formula_magic_3
		}
		if = {
			limit = {
				learning = 25
			}
			prestige = 200
    		add_artifact = arcane_theory_formula_magic_4
		}
		remove_character_modifier = dw_writing_arcane_theory
	}
}

#Write a Magnum Opus - Finish book on Astrology with focus on Stars
character_event = {
	id = DWSOC.1606
	desc = EVTDESC_MNM_1606
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = { #Awesome!
		name = EVTOPTA_MNM_1606
		if = {
			limit = {
				NOT = { learning = 12 }
			}
			prestige = 50
    		add_artifact = arcane_theory_magic_techniques_1
		}
		if = {
			limit = {
				learning = 12
				NOT = { learning = 18 }
			}
			prestige = 100
    		add_artifact = arcane_theory_magic_techniques_2
		}
		if = {
			limit = {
				learning = 18
				NOT = { learning = 25 }
			}
			prestige = 150
    		add_artifact = arcane_theory_magic_techniques_3
		}
		if = {
			limit = {
				learning = 25
			}
			prestige = 200
    		add_artifact = arcane_theory_magic_techniques_4
		}
		remove_character_modifier = dw_writing_arcane_theory
	}
}

#Write a Magnum Opus - Finish book on Astrology with focus on Planets
character_event = {
	id = DWSOC.1607
	desc = EVTDESC_MNM_1607
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = { #Awesome!
		name = EVTOPTA_MNM_1607
		if = {
			limit = {
				NOT = { learning = 12 }
			}
			prestige = 50
    		add_artifact = arcane_theory_magic_forms_1
		}
		if = {
			limit = {
				learning = 12
				NOT = { learning = 18 }
			}
			prestige = 100
    		add_artifact = arcane_theory_magic_forms_2
		}
		if = {
			limit = {
				learning = 18
				NOT = { learning = 25 }
			}
			prestige = 150
    		add_artifact = arcane_theory_magic_forms_3
		}
		if = {
			limit = {
				learning = 25
			}
			prestige = 200
    		add_artifact = arcane_theory_magic_forms_4
		}
		remove_character_modifier = dw_writing_arcane_theory
	}
}

#Write a Magnum Opus - Finish book on Alchemy with focus on Universal Panacea
character_event = {
	id = DWSOC.1608
	desc = EVTDESC_MNM_1608
	picture = GFX_evt_experiment
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = { #Awesome!
		name = EVTOPTA_MNM_1608
    	if = {
			limit = {
				NOT = { learning = 12 }
			}
			prestige = 50
    		add_artifact = arcane_theory_arcane_bestiary_1
		}
		if = {
			limit = {
				learning = 12
				NOT = { learning = 18 }
			}
			prestige = 100
    		add_artifact = arcane_theory_arcane_bestiary_2
		}
		if = {
			limit = {
				learning = 18
				NOT = { learning = 25 }
			}
			prestige = 150
    		add_artifact = arcane_theory_arcane_bestiary_3
		}
		if = {
			limit = {
				learning = 25
			}
			prestige = 200
    		add_artifact = arcane_theory_arcane_bestiary_4
		}
		remove_character_modifier = dw_writing_arcane_theory
	}
}

#Write a Magnum Opus - Finish book on Alchemy with focus on Transmutation
character_event = {
	id = DWSOC.1609
	desc = EVTDESC_MNM_1609
	picture = GFX_evt_experiment
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = { #Awesome!
		name = EVTOPTA_MNM_1609
		if = {
			limit = {
				NOT = { learning = 12 }
			}
			prestige = 50
    		add_artifact = arcane_theory_realms_power_1
		}
		if = {
			limit = {
				learning = 12
				NOT = { learning = 18 }
			}
			prestige = 100
    		add_artifact = arcane_theory_realms_power_2
		}
		if = {
			limit = {
				learning = 18
				NOT = { learning = 25 }
			}
			prestige = 150
    		add_artifact = arcane_theory_realms_power_3
		}
		if = {
			limit = {
				learning = 25
			}
			prestige = 200
    		add_artifact = arcane_theory_realms_power_4
		}
		remove_character_modifier = dw_writing_arcane_theory
	}
}

