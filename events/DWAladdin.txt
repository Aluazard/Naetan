##DWFairyTales.3000 - Aladdin

namespace = DWFairyTales

### Aladdin's Lamp
# .3000 Player Rubbed the Lamp to summon the Genie
narrative_event = {
	id = DWFairyTales.3000
	desc = DWFairyTales3000
	picture = alladin_genie1
	title = dw_aladdins_lamp_title
	ai = no # We only want the player rubbing the lamp and getting a response
	is_triggered_only = yes # Triggered by decision
	immediate = {
		# If the person using the lamp hasn't made any wishes yet, we go and set the wish counter
		if = {
			limit = {
				NOT = { check_variable = { which = genie_wishes_made value = 0} }
			}
		}
	}
	option = { # Just wanted to talk
		name = DWFairyTales3000A
	}
	option = { # Wish for Genie's Freedom
		trigger = {
			check_variable = { which = genie_wishes_made value = 2 } # If it's the last wish, the genie's freedom can be wished for.
		}
		name = DWFairyTales3000B
		# TODO a proper event, for now we just directly execute the one that adds the Genie NPC
		character_event = { id = DWFairyTales.15 }
		hidden_effect = { change_variable = { which = genie_wishes_made value = 1 } }
	}
	option = { # Wish for Jasmine's Freedom
		trigger = {
			NOT = { has_global_flag = dw_npc_jasmine_created } # Only one Jasmine per game can be wished for
		}
		name = DWFairyTales3000C
		# TODO a proper event, for now we just directly execute the one that adds the Jasmine NPC
		character_event = { id = DWFairyTales.13 }
		hidden_effect = { change_variable = { which = genie_wishes_made value = 1 } }
	}
	option = { # Wish for immense wealth
		trigger = {
			NOT = { has_character_flag = dw_wished_for_wealth }
		}
		name = DWFairyTales3000D
		wealth = 5000
		hidden_effect = { 
			change_variable = { which = genie_wishes_made value = 1 } 
			set_character_flag = dw_wished_for_wealth
		}
	}
	option = { # Wish for fame
		trigger = {
			NOT = { has_character_flag = dw_wished_for_fame }
		}
		name = DWFairyTales3000E
		prestige = 5000
		hidden_effect = { 
			change_variable = { which = genie_wishes_made value = 1 } 
			set_character_flag = dw_wished_for_fame
		}
	}
}