### This file contains both normal and targeted decisions related to the Children of Lilith mod
decisions = {
	# Child of Lilith Campaign Style Selection
	dw_child_of_lilith_campaign = {
		potential = {
			ai = no # Only the player should ever see this
			has_lilith_start = yes
			has_heaven_hell_content = yes
			has_dw_campaign_started = no
		}
		allow = {
			always = yes # It should always be displayed if it is relevant
		}
		effect = {
			set_global_flag = dw_campaign_started
			character_event = { id = DWLilith.10 }
		}
		ai_will_do = {
			factor = 0 # Zero chance the ai uses this
		}
	}
	#Call for a Blood Moon Ritual in honor of Lilith
	dw_blood_moon_ritual = {
		is_high_prio = yes # Will show an alert once decision is enabled
		potential = {
			is_ruler = yes
			prisoner = no
			is_col = yes # Child of Lilith
			NOT = {
				has_character_modifier = dw_holding_lilith_blood_ritual
			}
		}
		allow = {
			war = no
			prisoner = no
			NOT = { trait = in_hiding }
			wealth = 25
			month = 4
			NOT = { month = 6 }
			custom_tooltip = {
				text = dw_blood_moon_cooldown
				hidden_tooltip = { NOT = { has_character_flag = dw_blood_moon_cooldown } }
			}
		}
		effect = {
			add_character_modifier = {
				name = dw_holding_lilith_blood_ritual
				duration = 45
			}
			set_character_flag = dw_blood_moon_cooldown
			character_event = { id = DWLilith.1000} 
		}
		ai_will_do = {
			#Factors for an AI character to take the decision (1 = 100% chance)
			factor = 0.2 # 20% chance
			modifier = {
				factor = 0
				OR = {
					NOT = { ai_zeal = -50 } # Not interested in using their time to recognize Lilith ( An ai_zeal score that is less than -50)
					NOT = { ai_ambition = -20 } # They're too content with their lot in life to be interested in the gifts that Lilith can provide ( an ai_ambition score that is less than -20)
				}
			}
		}
	}
}
targetted_decisions = {
	### Begin Targeted Spells
	# Spell for clearing off Lover's Pox from self (Stage 0)
	dw_pox_purge = {
		filter = self
		ai_target_filter = self
		from_potential = {
			# Check for Child of Lilith moved to the potential field as CK2's ai was apparently ignoring the trait and modifier check, based on troubleshooting from Venator.
		}
		potential = {
			character = FROM
			is_col = yes # Child of Lilith
		}
		allow = {
			piety = 10 # This is a minor power, and requires little spiritual energy
			OR = {
				has_character_modifier = minor_disease_herpes
				trait = lovers_pox
			}
		}
		effect = {
			character_event = { id = DWLilith.100 } # Self targeted
		}
		ai_will_do = {
			factor = 1 # Percentage based, we're assuming that an ai Succubus or Incubus will opt to cleanse themselves
			modifier = {
				factor = 0 # Unless they're misleading pricks to their sex partners, then they don't clean themselves, opting instead to spread the disease
				OR = {
					trait = cruel
					ai_honor = -30
				}
			}
		}
	}
	#Kiss of Seduction (Stage 1)
	dw_kiss_of_seduction = {
		filter = all
		ai_target_filter = realm
		from_potential = {
			NOT = { trait = incapable } # Hard to kiss someone when you're a vegetable
			prisoner = no # Very difficult from behind bars as well
			NOT = { has_any_opinion_modifier = opinion_seducing } # We're using the opinion modifier that is also used by the normal seducing method, as we don't want to overlap
			is_at_least_col1 = yes # Child of Lilith Stage 1+
		}		
		potential = {
			is_adult = yes
			NOT = { character = FROM } # No seducing ourselves
			NOT = { trait = incapable } # Vegetable's are hard to seduce
			prisoner = no # While tempting, let's leave the captive audience alone
			NOT = { is_lover = FROM } # No need to seduce someone who we've already landed
			NOT = { is_consort = FROM } # No need to seduce someone who we already own
			NOT = { any_spouse = { character = FROM } } # No need to seduce someone who we've already landed
		}
		allow = {
			is_within_diplo_range = FROM # They should be in diplomatic traveling distance
			NOT = { # Changed to NOT - as a nor could block an individual who rejected someone else from being targeted, so both items need to be present to reject it.
				has_opinion_modifier = { who = FROM modifier = opinion_seduced_refused }
				has_character_modifier = dismissed_proposal
			}
		}
		effect = {
			hidden_tooltip = {
				FROM = {
					opinion = {
						who = ROOT
						modifier = opinion_seducing # Placing this keeps us from being able to overlap with the normal seduction, and limits to pursuing only one person at a time
						years = 1000
					}
					if = {
						limit = {
							is_close_relative = ROOT
							NOT = { religion = messalian }
							NOT = { religion = zoroastrian }
						}
						narrative_event = { id = DWLilith.5002 days = 1 } # Warning - Incest scandal risk
						break = yes
					}				
					if = {
						limit = {
							same_sex = ROOT
						}
						narrative_event = { id = DWLilith.5004 days = 1 } # Warning - Homosexual scandal risk
						break = yes
					}					
					if = {
						limit = {
							religion_group = christian
							OR = {
								is_priest = yes
								trait = monk
								trait = nun
								ROOT = { is_priest = yes }
								ROOT = { trait = monk }
								ROOT = { trait = nun }
							}
						}
						narrative_event = { id = DWLilith.5003 days = 1 } # Warning - Priest scandal risk
						break = yes
					}					
					if = {
						limit = { 
							age_diff = {
								who = ROOT
								years = 25
							}
						}
						narrative_event = { id = DWLilith.5005 days = 1 } # Warning - Age scandal risk
						break = yes
					}
					if  = {
						limit = {
							trait = incubus
						}
						narrative_event = { id = DWLilith.5001 days = 1 } # No warning - Incubus start
						break = yes # we break out of the effect block
					}					
					# If we reach here, it's the Succubus default start
					narrative_event = { id = DWLilith.5000 days = 1 } # No warning - Succubus start
				}
			}
		}
		ai_will_do = {
			factor = 0.25 # 25% chance
			modifier = {
				factor = 0
				OR = {
					FROM = { ai_honor = 50 } # If an incubus or succubus somehow becomes very honorable, they'll no longer seek to use this method to sway others
					FROM = { NOT = { ai_ambition = -40 }} # If there simply isn't the drive to seek a seduction conquest
					AND = { # No trying to seduce grannies that aren't immortal
						is_female = yes
						NOT = { trait = immortal }
						age = 50
					}
					FROM = { num_of_children = 12 } # We're calling it quits if the ai reaches a dozen
					FROM = { num_of_lovers = 3 } # The ai figures enough is enough at this point
					trait = ugly # We're setting some basic standards for the ai with the items below
					trait = dwarf
					trait = inbred
					trait = imbecile
					trait = clubfooted
					trait = harelip
					trait = hunchback
					trait = eunuch
					is_ill = yes
					is_pregnant = yes
				}
			}
			modifier = {
				factor = 0.5
				FROM = {
					num_of_children = 2 # Half as likely to do it if they've already a couple of kids
				}
			}
			modifier = {
				factor = 0.5
				FROM = {
					num_of_children = 4 # Half again as likely if they've 4
				}
			}
			modifier = {
				factor = 0.5
				FROM = {
					num_of_children = 8 # And only half again as likely if they've 8 kids (.25 * .5 * .5 * .5 = 3% )
				}
			}
			modifier = { # 4 times as likely to pursue them if they're good looking
				factor = 4
				trait = fair
			}
			modifier = {
				factor = 4 # 4 times as likely to do if the incubus/succubus is naturally inclined towards it
				FROM = {
					OR = {
						trait = lustful
						trait = hedonist
						trait = seducer
						trait = seductress
					}
				}
			}
		}
	}
	# Spell make self beautiful (Stage 1)
	dw_beautify_self = {
		filter = self
		ai_target_filter = self
		from_potential = {
			# Check for Child of Lilith moved to the potential field as CK2's ai was apparently ignoring the trait and modifier check, based on troubleshooting from Venator.
		}
		potential = {
			character = FROM
			is_at_least_col1 = yes # Child of Lilith Stage 1+
		}
		allow = {
			piety = 50
			OR = {  #No reason to cast it if they're already attractive
				NOT = { trait = fair }
				AND = { # An attractive female should still be able to cast this, to take her looks to the Bombshell step
					is_female = yes
					NOT = { trait = bombshell }
				}
			}
		}
		effect = {
			character_event = { id = DWLilith.110 } #Self target
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				NOT = { ai_ambition = -10 }# They lack the drive to improve themselves or simply don't view their looks as important in their lives ( an ai_ambition score that is less than -10)
			}
		}		
	}
	### Spell Life Leech (Stage 2)
	dw_life_leech_spell = {
		filter = all
		ai_target_filter = court
		ai_check_interval = 12 # To keep things from getting out of hand, we only want the ai to do it no more than once a year
		from_potential = {
			prisoner = no # Hard to leech someone from a prison cell
			NOT = { has_character_modifier = dw_lovers_embrace_cooldown }
			is_at_least_col2 = yes # Child of Lilith Stage 2+
		}
		potential = {
			is_adult = yes # No leeching the underage
		}
		allow = {
			is_within_diplo_range = FROM
			OR = {
				any_spouse = {
					character = FROM
				}
				is_lover = FROM
				is_consort = FROM
				AND = {
					trait = branded_slave
					host = { character = FROM }
				}
				AND = {
					prisoner = yes
					host = { character = FROM }
				}
				#Expand to include whores
			}
		}
		effect = {
			FROM = { narrative_event = { id = DWLilith.140 } } 
		}
		ai_will_do = {
			factor = 0.1
			modifier = {
				factor = 0
				piety = 100 # If the ai already has a piety of 100 or higher, we don't need for them to be draining anyone, less it gets carried away.
			}
		}
	}
	### Spell Alter Appearance (Stage 3)
	dw_alter_appearance = {
		filter = self
		ai_target_filter = self
		from_potential = {
			# Check for Child of Lilith moved to the potential field as CK2's ai was apparently ignoring the trait and modifier check, based on troubleshooting from Venator.
		}
		potential = {
			character = FROM # Should only be casting this on themselves
			is_at_least_col3 = yes # Child of Lilith Stage 3+
		}
		allow = {
			piety = 10
		}
		effect = {
			if = {
				limit = {
					trait = incubus
				}
				narrative_event = {	id = DWLilith.150 } #Incubus Specific
			}
			if = {
				limit = {
					trait = lilith
				}
				narrative_event = {	id = DWLilith.155 } #Succubus Specific
			}
		}
		ai_will_do = {
			factor = 0 # We don't want the ai constantly changing how it looks. Or at least I don't. If you do, then change the 0 to anything from a 1 (100%) to a 0.01 (1%) chance
		}		
	}
	### Futanari Morph (Stage 3)
	dw_futa_morph_spell = {
		filter = self
		ai_target_filter = self
		from_potential = {
			# Check for Child of Lilith moved to the potential field as CK2's ai was apparently ignoring the trait and modifier check, based on troubleshooting from Venator.
		}
		potential = {
			character = FROM # Should only be casting this on themselves
			is_at_least_succubus3 = yes # Succubus Stage 3+
		}
		allow = {
			piety = 50
			has_gender_bender_content = yes
		}
		effect = {
			narrative_event = {	id = DWLilith.220 }
		}
		ai_will_do = {
			factor = 0 # We don't want the ai constantly changing how it looks. Or at least I don't. If you do, then change the 0 to anything from a 1 (100%) to a 0.01 (1%) chance
		}		
	}
	### Spell minor body damage recovery (Stage 3)
	dw_lilith_minor_heal_self = {
		filter = self
		ai_target_filter = self
		from_potential = {
			# Check for Child of Lilith moved to the potential field as CK2's ai was apparently ignoring the trait and modifier check, based on troubleshooting from Venator.
		}
		potential = {
			character = FROM # Should only be casting this on themselves
			is_at_least_col3 = yes # Children of Lilith Stage 3
		}
		allow = {
			piety = 50
			OR = {
				trait = wounded
				trait = ill
				trait = flu
				trait = dysentery
				trait = gout
				trait = cough
				trait = fever
				trait = diarrhea
				trait = vomiting
				trait = chest_pain
				trait = cramps
				trait = rash
				trait = headache
				trait = abdominal_pain
				trait = fatigue
				trait = malaise
				trait = infection
			}
		}
		effect = {
			narrative_event = {	id = DWLilith.200 } #Self target
		}
		ai_will_do = {
			factor = 1 # 100%
			modifier = {
				factor = 0
				OR = {				
					age = 100 # If they've lived long enough in the mortal realm, they're opting to not heal themselves
					NOT = { ai_ambition = -40 } # If they're content with what they've done and have no motivation to heal ( ai_ambition less than -40 )
				}
			}
		}		
	}
	### Spell moderate body damage recovery (Stage 4)
	dw_lilith_moderate_heal_self = {
		filter = self
		ai_target_filter = self
		from_potential = {
			# Check for Child of Lilith moved to the potential field as CK2's ai was apparently ignoring the trait and modifier check, based on troubleshooting from Venator.
		}
		potential = {
			character = FROM # Should only be casting this on themselves
			is_at_least_col4 = yes # Children of Lilith Stage 4
		}
		allow = {
			piety = 75
			OR = {
				trait = maimed
				trait = pneumonic
				trait = syphilitic
				trait = has_tuberculosis
				trait = has_typhoid_fever
				trait = has_typhus
				trait = has_measles
				trait = food_poisoning
				trait = scurvy
				trait = disfigured
				trait = mangled
				trait = severely_injured
				trait = clubfooted
				trait = harelip
				trait = hunchback
				trait = lisp
			}
		}
		effect = {
			narrative_event = {	id = DWLilith.210 } #Self target
		}
		ai_will_do = {
			factor = 1 # 100%
			modifier = {
				factor = 0
				OR = {				
					age = 100 # If they've lived long enough in the mortal realm, they're opting to not heal themselves
					NOT = { ai_ambition = -40 } # If they're content with what they've done and have no motivation to heal ( ai_ambition less than -40 )
				}
			}
		}		
	}
	### Spell Incubus Intimidation (Stage 4 - Incubus only)
	dw_incubus_intimidation_illusion = {
		filter = all
		ai_target_filter = realm
		from_potential = {
			is_at_least_incubus4 = yes # Incubus Stage 4+
		}
		potential = {
			NOT = { character = FROM } # Should NOT be casting this on themselves
		}
		allow = {
			is_within_diplo_range = FROM
			FROM = { piety = 50 }
		}
		effect = {
			FROM = { narrative_event = { id = DWLilith.160 }}
		}
		ai_will_do = {
			factor = .1 # 10%
			modifier = {
				factor = 0
				FROM = { personal_opinion = { who = ROOT value = 1}} # If the ai has a positive opinion of the target, they'll opt not to target them
			}
		}		
	}
	### Spell Corruption (Stage 4 - Succubus only)
	dw_succubus_corruption = {
		filter = all
		ai_target_filter = realm
		from_potential = {
			is_at_least_succubus4 = yes # Succubus Stage 4+
		}
		potential = {
			NOT = { character = FROM } # Shouldn't be casting this on themselves
		}
		allow = {
			FROM = { piety = 50 }
		}
		effect = {
			FROM = { narrative_event = { id = DWLilith.180 } }
		}
		ai_will_do = {
			factor = .1 # 10%
			modifier = {
				factor = 0
				OR = {
					is_friend = FROM # Friends don't corrupt other friends (well, not via shitty diseases anyway)
					FROM = { personal_opinion = { who = ROOT value = 1}} # If the ai has a positive opinion of the target, they'll opt not to target them
				}
			}
		}		
	}
	### Spell Shape Cock (Stage 4)
	dw_alter_cock_size = {
		filter = self
		ai_target_filter = self
		from_potential = {
			# Check for Child of Lilith moved to the potential field as CK2's ai was apparently ignoring the trait and modifier check, based on troubleshooting from Venator.
		}
		potential = {
			character = FROM # Should only be casting this on themselves
			is_at_least_col4_cock = yes # Child of Lilith Stage 4+ and has a cock		
		}
		allow = {
			piety = 50
		}
		effect = {
			narrative_event = {	id = DWLilith.170 } #Incubus image, but used for both until a futa specific image and event is added
			# TODO Add futa succubus image/event
		}
		ai_will_do = {
			factor = .1 # 10% chance, it may be interesting to see the ai randomly swapping their penis size around
		}		
	}
	### Spell major body damage recovery (Stage 5)
	dw_lilith_major_heal_self = {
		filter = self
		ai_target_filter = self
		from_potential = {
			# Check for Child of Lilith moved to the potential field as CK2's ai was apparently ignoring the trait and modifier check, based on troubleshooting from Venator.
		}
		potential = {
			character = FROM # Should only be casting this on themselves
			is_col5 = yes # Children of Lilith Stage 5
		}
		allow = {
			piety = 100
			OR = {
				trait = leper
				trait = has_bubonic_plague
				trait = has_small_pox
				trait = has_aztec_disease
				trait = rabies
				trait = cancer
				trait = dancing_plague
				trait = infirm
				trait = incapable
				trait = one_eyed
				trait = one_handed
				trait = one_legged
			}
		}
		effect = {
			narrative_event = {	id = DWLilith.120 } #Self target
		}
		ai_will_do = {
			factor = 1 # 100%
			modifier = {
				factor = 0
				OR = {				
					age = 100 # If they've lived long enough in the mortal realm, they're opting to not heal themselves - since being incapable will then lead to them also removing their immortality
					NOT = { ai_ambition = -40 } # If they're content with what they've done and have no motivation to heal ( ai_ambition less than -40 )
				}
			}
		}		
	}
	### Spell immortality (Stage 5)
	dw_lilith_immortality = {
		filter = realm_including_me
		ai_target_filter = self
		from_potential = {
			is_col5 = yes # Children of Lilith Stage 5
			ai = no # For right now, we only want the player to be able to cast this spell
		}
		potential = {
			is_adult = yes #Doing this, just to avoid having immortal kids running around. That creeped me out as it was in Interview with a Vampire
			NOT = { trait = immortal } # The target isn't already immortal
		}
		allow = {
			is_within_diplo_range = FROM # The target should be within reasonable travel range
			FROM = { piety = 250 } # The cost for casting the spell
		}
		effect = {
			FROM = { narrative_event = { id = DWLilith.190 }}
		}
		ai_will_do = {
			factor = 0 # Nope
		}		
	}
	### Spell Incubus Death Dream (Stage 5 - Incubus only)
	dw_lilith_incubus_death_dream = {
		filter = all
		ai_target_filter = realm
		from_potential = {
			is_incubus5 = yes # Incubus Stage 5
		}
		potential = {
			NOT = { character = FROM } # Should NOT be casting this on themselves
		}
		allow = {
			is_within_diplo_range = FROM
			FROM = { piety = 500 }
		}
		effect = {
			FROM = { narrative_event = { id = DWLilith.130 }}
		}
		ai_will_do = {
			factor = .1 # 10%
			modifier = {
				factor = 0
				OR = {
					is_friend = FROM # Friends don't Death Dream Friends
					FROM = { personal_opinion = { who = ROOT value = 1}} # If the ai has a positive opinion of the target, they'll opt not to target them					
				}
			}
		}		
	}
}